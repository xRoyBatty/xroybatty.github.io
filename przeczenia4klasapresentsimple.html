<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Present Simple Negative - Interactive Tasks</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.2em;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #f0f0f0;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            width: 0%;
            transition: width 0.5s ease;
        }

        .task {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .task.active {
            display: block;
        }

        .task-header {
            background: linear-gradient(90deg, #4CAF50, #45a049);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .task-header h2 {
            font-size: 1.8em;
            margin-bottom: 5px;
        }

        .task-header p {
            opacity: 0.9;
        }

        .vocabulary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .vocab-words, .vocab-definitions {
            min-height: 400px;
            border: 2px dashed #ddd;
            border-radius: 10px;
            padding: 20px;
        }

        .vocab-item {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            cursor: grab;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            user-select: none;
        }

        .vocab-item:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        .vocab-item.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .definition-slot {
            background: #fff;
            border: 2px dashed #4CAF50;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            min-height: 60px;
            transition: all 0.3s ease;
        }

        .definition-slot.filled {
            border-color: #45a049;
            background: #f1f8f1;
        }

        .definition-slot.correct {
            background: #d4edda;
            border-color: #28a745;
        }

        .definition-slot.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .grammar-rules {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #4CAF50;
        }

        .rule-item {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .rule-item:hover {
            background: #e8f5e8;
            transform: translateX(10px);
        }

        .rule-explanation {
            display: none;
            margin-top: 10px;
            padding: 15px;
            background: #e8f5e8;
            border-radius: 5px;
            font-style: italic;
        }

        .multiple-choice {
            margin: 20px 0;
        }

        .question {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .question h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .option {
            background: white;
            border: 2px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .option:hover {
            background: #f0f0f0;
            border-color: #4CAF50;
        }

        .option.selected {
            background: #4CAF50;
            color: white;
            border-color: #45a049;
        }

        .option.correct {
            background: #28a745;
            color: white;
        }

        .option.incorrect {
            background: #dc3545;
            color: white;
        }

        .gap-fill {
            margin: 20px 0;
        }

        .sentence {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 1.2em;
        }

        .gap {
            display: inline-block;
            min-width: 100px;
            padding: 8px 15px;
            border: 2px solid #4CAF50;
            border-radius: 5px;
            background: white;
            margin: 0 5px;
        }

        .gap input {
            border: none;
            background: transparent;
            font-size: 1em;
            width: 100%;
            text-align: center;
            outline: none;
        }

        .transform-exercise {
            margin: 20px 0;
        }

        .sentence-pair {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .original {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .transform-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #4CAF50;
            border-radius: 8px;
            font-size: 1.1em;
            outline: none;
        }

        .writing-area {
            margin: 20px 0;
        }

        .writing-prompt {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #4CAF50;
        }

        .writing-input {
            width: 100%;
            min-height: 200px;
            padding: 20px;
            border: 2px solid #4CAF50;
            border-radius: 10px;
            font-size: 1.1em;
            resize: vertical;
            outline: none;
        }

        .controls {
            text-align: center;
            margin: 30px 0;
        }

        .btn {
            background: linear-gradient(90deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            margin: 0 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .feedback {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
        }

        .feedback.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .timer {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            font-weight: bold;
            color: #333;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .vocabulary-grid {
                grid-template-columns: 1fr;
            }
            
            .options {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="timer">
        Czas: <span id="timer">00:00</span>
    </div>

    <div class="container">
        <div class="header">
            <h1>Present Simple - Forma Przecząca</h1>
            <p>6 Interaktywnych Zadań - 45 Minut</p>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <!-- Task 1: Vocabulary Matching -->
        <div class="task active" id="task1">
            <div class="task-header">
                <h2>Zadanie 1: Dopasowywanie Słownictwa</h2>
                <p>Przeciągnij słowa i dopasuj je do definicji (7-8 minut)</p>
            </div>
            
            <div class="vocabulary-grid">
                <div class="vocab-words" id="vocabWords">
                    <h3>Zwroty</h3>
                    <div class="vocab-item" draggable="true" data-word="get up">get up</div>
                    <div class="vocab-item" draggable="true" data-word="like">like</div>
                    <div class="vocab-item" draggable="true" data-word="eat">eat</div>
                    <div class="vocab-item" draggable="true" data-word="hang out">hang out</div>
                    <div class="vocab-item" draggable="true" data-word="watch">watch</div>
                    <div class="vocab-item" draggable="true" data-word="tidy">tidy</div>
                    <div class="vocab-item" draggable="true" data-word="listen to">listen to</div>
                    <div class="vocab-item" draggable="true" data-word="speak">speak</div>
                    <div class="vocab-item" draggable="true" data-word="go to school">go to school</div>
                    <div class="vocab-item" draggable="true" data-word="do homework">do homework</div>
                    <div class="vocab-item" draggable="true" data-word="go out">go out</div>
                    <div class="vocab-item" draggable="true" data-word="play">play</div>
                </div>
                
                <div class="vocab-definitions" id="vocabDefinitions">
                    <h3>Definicje</h3>
                    <div class="definition-slot" data-word="tidy">sprzątać, porządkować</div>
                    <div class="definition-slot" data-word="go to school">chodzić do szkoły</div>
                    <div class="definition-slot" data-word="get up">wstawać z łóżka</div>
                    <div class="definition-slot" data-word="do homework">odrabiać lekcje</div>
                    <div class="definition-slot" data-word="listen to">słuchać (muzyki)</div>
                    <div class="definition-slot" data-word="watch">oglądać (TV, filmy)</div>
                    <div class="definition-slot" data-word="speak">mówić (w języku)</div>
                    <div class="definition-slot" data-word="eat">jeść, spożywać</div>
                    <div class="definition-slot" data-word="hang out">spędzać czas z przyjaciółmi</div>
                    <div class="definition-slot" data-word="play">grać, bawić się</div>
                    <div class="definition-slot" data-word="like">lubić coś</div>
                    <div class="definition-slot" data-word="go out">wychodzić z domu</div>
                </div>
            </div>
            
            <div class="feedback" id="vocabFeedback" style="display: none;"></div>
        </div>

        <!-- Task 2: Grammar Rules Interactive -->
        <div class="task" id="task2">
            <div class="task-header">
                <h2>Zadanie 2: Zasady Gramatyczne</h2>
                <p>Kliknij na każdą zasadę, aby zobaczyć przykłady (7-8 minut)</p>
            </div>
            
            <div class="grammar-rules">
                <div class="rule-item" onclick="toggleRule('rule1')">
                    <strong>Zasada 1: I, You, We, They + don't</strong>
                    <div class="rule-explanation" id="rule1">
                        <p>Używamy "don't" (do not) z podmiotami: I, you, we, they</p>
                        <p><strong>Przykłady:</strong></p>
                        <p>• I don't get up early. (Nie wstaję wcześnie.)</p>
                        <p>• You don't like pop music. (Nie lubisz muzyki pop.)</p>
                        <p>• We don't watch TV. (Nie oglądamy telewizji.)</p>
                        <p>• They don't play games. (Oni nie grają w gry.)</p>
                    </div>
                </div>
                
                <div class="rule-item" onclick="toggleRule('rule2')">
                    <strong>Zasada 2: He, She, It + doesn't</strong>
                    <div class="rule-explanation" id="rule2">
                        <p>Używamy "doesn't" (does not) z podmiotami: he, she, it</p>
                        <p><strong>Przykłady:</strong></p>
                        <p>• He doesn't go to school. (On nie chodzi do szkoły.)</p>
                        <p>• She doesn't tidy her room. (Ona nie sprząta swojego pokoju.)</p>
                        <p>• It doesn't eat cupcakes. (Ono nie je babeczek.)</p>
                        <p>• My cat doesn't like water. (Mój kot nie lubi wody.)</p>
                    </div>
                </div>
                
                <div class="rule-item" onclick="toggleRule('rule3')">
                    <strong>Zasada 3: Forma Pełna vs Skrócona</strong>
                    <div class="rule-explanation" id="rule3">
                        <p>Możesz używać formy pełnej lub skróconej</p>
                        <p><strong>Przykłady:</strong></p>
                        <p>• do not = don't</p>
                        <p>• does not = doesn't</p>
                        <p>• I do not like coffee. = I don't like coffee. (Nie lubię kawy.)</p>
                        <p>• She does not speak French. = She doesn't speak French. (Ona nie mówi po francusku.)</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Task 3: Multiple Choice -->
        <div class="task" id="task3">
            <div class="task-header">
                <h2>Zadanie 3: Wybór Wielokrotny</h2>
                <p>Wybierz poprawną formę przeczącą (7-8 minut)</p>
            </div>
            
            <div class="multiple-choice" id="multipleChoice">
                <div class="question" data-question="0">
                    <h3>You _____ do homework on weekends.</h3>
                    <div class="options">
                        <div class="option" onclick="selectOption(0, 0, 'doesn\'t')">doesn't</div>
                        <div class="option" onclick="selectOption(0, 1, 'don\'t')">don't</div>
                        <div class="option" onclick="selectOption(0, 2, 'aren\'t')">aren't</div>
                        <div class="option" onclick="selectOption(0, 3, 'not')">not</div>
                    </div>
                </div>
                
                <div class="question" data-question="1">
                    <h3>My friends _____ hang out after school.</h3>
                    <div class="options">
                        <div class="option" onclick="selectOption(1, 0, 'not')">not</div>
                        <div class="option" onclick="selectOption(1, 1, 'doesn\'t')">doesn't</div>
                        <div class="option" onclick="selectOption(1, 2, 'don\'t')">don't</div>
                        <div class="option" onclick="selectOption(1, 3, 'aren\'t')">aren't</div>
                    </div>
                </div>
                
                <div class="question" data-question="2">
                    <h3>I _____ like coffee.</h3>
                    <div class="options">
                        <div class="option" onclick="selectOption(2, 0, 'not')">not</div>
                        <div class="option" onclick="selectOption(2, 1, 'doesn\'t')">doesn't</div>
                        <div class="option" onclick="selectOption(2, 2, 'am not')">am not</div>
                        <div class="option" onclick="selectOption(2, 3, 'don\'t')">don't</div>
                    </div>
                </div>
                
                <div class="question" data-question="3">
                    <h3>My cat _____ like water.</h3>
                    <div class="options">
                        <div class="option" onclick="selectOption(3, 0, 'don\'t')">don't</div>
                        <div class="option" onclick="selectOption(3, 1, 'doesn\'t')">doesn't</div>
                        <div class="option" onclick="selectOption(3, 2, 'isn\'t')">isn't</div>
                        <div class="option" onclick="selectOption(3, 3, 'not')">not</div>
                    </div>
                </div>
                
                <div class="question" data-question="4">
                    <h3>We _____ watch TV in the morning.</h3>
                    <div class="options">
                        <div class="option" onclick="selectOption(4, 0, 'not')">not</div>
                        <div class="option" onclick="selectOption(4, 1, 'aren\'t')">aren't</div>
                        <div class="option" onclick="selectOption(4, 2, 'don\'t')">don't</div>
                        <div class="option" onclick="selectOption(4, 3, 'doesn\'t')">doesn't</div>
                    </div>
                </div>
                
                <div class="question" data-question="5">
                    <h3>She _____ go to work on Sundays.</h3>
                    <div class="options">
                        <div class="option" onclick="selectOption(5, 0, 'isn\'t')">isn't</div>
                        <div class="option" onclick="selectOption(5, 1, 'doesn\'t')">doesn't</div>
                        <div class="option" onclick="selectOption(5, 2, 'not')">not</div>
                        <div class="option" onclick="selectOption(5, 3, 'don\'t')">don't</div>
                    </div>
                </div>
                
                <div class="question" data-question="6">
                    <h3>They _____ eat meat.</h3>
                    <div class="options">
                        <div class="option" onclick="selectOption(6, 0, 'not')">not</div>
                        <div class="option" onclick="selectOption(6, 1, 'don\'t')">don't</div>
                        <div class="option" onclick="selectOption(6, 2, 'doesn\'t')">doesn't</div>
                        <div class="option" onclick="selectOption(6, 3, 'aren\'t')">aren't</div>
                    </div>
                </div>
                
                <div class="question" data-question="7">
                    <h3>He _____ speak German.</h3>
                    <div class="options">
                        <div class="option" onclick="selectOption(7, 0, 'doesn\'t')">doesn't</div>
                        <div class="option" onclick="selectOption(7, 1, 'isn\'t')">isn't</div>
                        <div class="option" onclick="selectOption(7, 2, 'not')">not</div>
                        <div class="option" onclick="selectOption(7, 3, 'don\'t')">don't</div>
                    </div>
                </div>
            </div>
            
            <div class="feedback" id="mcFeedback" style="display: none;"></div>
        </div>

        <!-- Task 4: Gap Fill -->
        <div class="task" id="task4">
            <div class="task-header">
                <h2>Zadanie 4: Uzupełnij Zdania</h2>
                <p>Wpisz don't lub doesn't + czasownik (7-8 minut)</p>
            </div>
            
            <div class="gap-fill">
                <div class="sentence">
                    We <span class="gap"><input type="text" placeholder="don't watch" data-answer="don't watch"></span> TV before dinner.
                </div>
                
                <div class="sentence">
                    I <span class="gap"><input type="text" placeholder="don't tidy" data-answer="don't tidy"></span> my room every day.
                </div>
                
                <div class="sentence">
                    You <span class="gap"><input type="text" placeholder="don't like" data-answer="don't like"></span> pop music.
                </div>
                
                <div class="sentence">
                    They <span class="gap"><input type="text" placeholder="don't hang out" data-answer="don't hang out"></span> with us anymore.
                </div>
                
                <div class="sentence">
                    My little sister <span class="gap"><input type="text" placeholder="doesn't go" data-answer="doesn't go"></span> to school.
                </div>
                
                <div class="sentence">
                    Cats <span class="gap"><input type="text" placeholder="don't eat" data-answer="don't eat"></span> cupcakes.
                </div>
                
                <div class="sentence">
                    She <span class="gap"><input type="text" placeholder="doesn't listen to" data-answer="doesn't listen to"></span> classical music.
                </div>
                
                <div class="sentence">
                    My cousin <span class="gap"><input type="text" placeholder="doesn't speak" data-answer="doesn't speak"></span> French.
                </div>
            </div>
            
            <div class="feedback" id="gapFeedback" style="display: none;"></div>
        </div>

        <!-- Task 5: Sentence Transformation -->
        <div class="task" id="task5">
            <div class="task-header">
                <h2>Zadanie 5: Przekształć Zdania</h2>
                <p>Zmień zdania twierdzące na przeczące (7-8 minut)</p>
            </div>
            
            <div class="transform-exercise">
                <div class="writing-prompt">
                    <h3>Przykład:</h3>
                    <p><strong>Zdanie twierdzące:</strong> I like pizza.</p>
                    <p><strong>Zdanie przeczące:</strong> I don't like pizza.</p>
                    <p><strong>Zasada:</strong> podmiot + don't/doesn't + czasownik</p>
                </div>
                
                <div class="sentence-pair">
                    <div class="original">We go out on weekends.</div>
                    <input type="text" class="transform-input" placeholder="We don't go out on weekends." data-answer="We don't go out on weekends">
                </div>
                
                <div class="sentence-pair">
                    <div class="original">The dog eats vegetables.</div>
                    <input type="text" class="transform-input" placeholder="The dog doesn't eat vegetables." data-answer="The dog doesn't eat vegetables">
                </div>
                
                <div class="sentence-pair">
                    <div class="original">Mum listens to classical music.</div>
                    <input type="text" class="transform-input" placeholder="Mum doesn't listen to classical music." data-answer="Mum doesn't listen to classical music">
                </div>
                
                <div class="sentence-pair">
                    <div class="original">Dad gets up early.</div>
                    <input type="text" class="transform-input" placeholder="Dad doesn't get up early." data-answer="Dad doesn't get up early">
                </div>
                
                <div class="sentence-pair">
                    <div class="original">My friends hang out after school.</div>
                    <input type="text" class="transform-input" placeholder="My friends don't hang out after school." data-answer="My friends don't hang out after school">
                </div>
                
                <div class="sentence-pair">
                    <div class="original">Jen and Alex play computer games.</div>
                    <input type="text" class="transform-input" placeholder="Jen and Alex don't play computer games." data-answer="Jen and Alex don't play computer games">
                </div>
            </div>
            
            <div class="feedback" id="transformFeedback" style="display: none;"></div>
        </div>

        <!-- Task 6: Creative Writing -->
        <div class="task" id="task6">
            <div class="task-header">
                <h2>Zadanie 6: Twórcze Pisanie</h2>
                <p>Napisz własne zdania używając formy przeczącej Present Simple (7-8 minut)</p>
            </div>
            
            <div class="writing-area">
                <div class="writing-prompt">
                    <h3>Napisz 8 zdań o tym, czego TY lub TWOJA RODZINA NIE robicie:</h3>
                    <p>• Używaj różnych podmiotów (I, you, he, she, it, we, they)</p>
                    <p>• Używaj don't z I, you, we, they</p>
                    <p>• Używaj doesn't z he, she, it</p>
                    <p>• Użyj czasowników jak: eat, watch, play, go, like, speak, hang out, listen to, itp.</p>
                    
                    <h4>Przykłady:</h4>
                    <p>• I don't eat meat. (Nie jem mięsa.)</p>
                    <p>• My sister doesn't play football. (Moja siostra nie gra w piłkę nożną.)</p>
                    <p>• We don't watch horror movies. (Nie oglądamy horrorów.)</p>
                    <p>• My cat doesn't like water. (Mój kot nie lubi wody.)</p>
                    <p>• They don't hang out with us. (Oni nie spędzają z nami czasu.)</p>
                </div>
                
                <textarea class="writing-input" id="writingInput" placeholder="Napisz tutaj swoje zdania...

1. I don't...
2. My mother doesn't...
3. We don't...
4. My friends don't...
5. He doesn't...
6. They don't...
7. She doesn't...
8. My family doesn't..."></textarea>
            </div>
            
            <div class="feedback" id="writingFeedback" style="display: none;"></div>
        </div>

        <div class="controls">
            <button class="btn" id="checkBtn" onclick="checkCurrentTask()">Sprawdź Odpowiedzi</button>
            <button class="btn" id="nextBtn" onclick="nextTask()" disabled>Następne Zadanie</button>
            <button class="btn" id="prevBtn" onclick="prevTask()" style="display: none;">Poprzednie Zadanie</button>
            <button class="btn" id="finishBtn" onclick="finishLesson()" style="display: none;">Zakończ Lekcję</button>
        </div>
    </div>

    <script>
        let currentTask = 1;
        let totalTasks = 6;
        let startTime = Date.now();
        let taskStartTime = Date.now();
        
        // Timer
        function updateTimer() {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            document.getElementById('timer').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        setInterval(updateTimer, 1000);

        // Progress tracking
        function updateProgress() {
            const progress = ((currentTask - 1) / totalTasks) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Task navigation
        function nextTask() {
            if (currentTask < totalTasks) {
                document.getElementById(`task${currentTask}`).classList.remove('active');
                currentTask++;
                document.getElementById(`task${currentTask}`).classList.add('active');
                updateProgress();
                resetButtons();
                taskStartTime = Date.now();
                
                if (currentTask === totalTasks) {
                    document.getElementById('nextBtn').style.display = 'none';
                    document.getElementById('finishBtn').style.display = 'inline-block';
                }
                if (currentTask > 1) {
                    document.getElementById('prevBtn').style.display = 'inline-block';
                }
            }
        }

        function prevTask() {
            if (currentTask > 1) {
                document.getElementById(`task${currentTask}`).classList.remove('active');
                currentTask--;
                document.getElementById(`task${currentTask}`).classList.add('active');
                updateProgress();
                resetButtons();
                taskStartTime = Date.now();
                
                if (currentTask === 1) {
                    document.getElementById('prevBtn').style.display = 'none';
                }
                if (currentTask < totalTasks) {
                    document.getElementById('nextBtn').style.display = 'inline-block';
                    document.getElementById('finishBtn').style.display = 'none';
                }
            }
        }

        function resetButtons() {
            document.getElementById('checkBtn').disabled = false;
            document.getElementById('nextBtn').disabled = true;
            document.querySelectorAll('.feedback').forEach(f => f.style.display = 'none');
        }

        // Task 1: Vocabulary Matching
        let draggedItem = null;
        let vocabMatches = {};

        document.querySelectorAll('.vocab-item').forEach(item => {
            item.addEventListener('dragstart', function(e) {
                draggedItem = this;
                this.classList.add('dragging');
            });
            
            item.addEventListener('dragend', function(e) {
                this.classList.remove('dragging');
            });
        });

        document.querySelectorAll('.definition-slot').forEach(slot => {
            slot.addEventListener('dragover', function(e) {
                e.preventDefault();
            });
            
            slot.addEventListener('drop', function(e) {
                e.preventDefault();
                if (draggedItem) {
                    const word = draggedItem.dataset.word;
                    const definition = this.dataset.word;
                    
                    // Clear previous content
                    this.innerHTML = this.innerHTML.split('<br>')[0];
                    
                    // Add the word
                    this.innerHTML += '<br><strong>' + draggedItem.textContent + '</strong>';
                    this.classList.add('filled');
                    
                    // Store the match
                    vocabMatches[definition] = word;
                    
                    // Hide the dragged item
                    draggedItem.style.opacity = '0.3';
                    draggedItem.draggable = false;
                }
            });
        });

        function checkVocabulary() {
            let correct = 0;
            let total = 12;
            
            document.querySelectorAll('.definition-slot').forEach(slot => {
                const correctWord = slot.dataset.word;
                const userWord = vocabMatches[correctWord];
                
                if (userWord === correctWord) {
                    slot.classList.add('correct');
                    correct++;
                } else {
                    slot.classList.add('incorrect');
                }
            });
            
            const feedback = document.getElementById('vocabFeedback');
            feedback.style.display = 'block';
            if (correct === total) {
                feedback.className = 'feedback success';
                feedback.textContent = 'Idealnie! Wszystkie słówka dopasowane poprawnie!';
            } else {
                feedback.className = 'feedback error';
                feedback.textContent = `${correct}/${total} poprawnych. Spróbuj ponownie!`;
            }
            
            return correct === total;
        }

        // Task 2: Grammar Rules
        function toggleRule(ruleId) {
            const rule = document.getElementById(ruleId);
            if (rule.style.display === 'block') {
                rule.style.display = 'none';
            } else {
                rule.style.display = 'block';
            }
        }

        function checkGrammarRules() {
            // All rules should be expanded to complete this task
            const rules = ['rule1', 'rule2', 'rule3'];
            let expanded = 0;
            
            rules.forEach(ruleId => {
                const rule = document.getElementById(ruleId);
                if (rule.style.display === 'block') {
                    expanded++;
                }
            });
            
            return expanded === 3;
        }

        // Task 3: Multiple Choice
        let mcAnswers = {};
        const correctAnswers = ['don\'t', 'don\'t', 'don\'t', 'doesn\'t', 'don\'t', 'doesn\'t', 'don\'t', 'doesn\'t'];

        function selectOption(questionIndex, optionIndex, answer) {
            // Clear previous selections
            const question = document.querySelector(`[data-question="${questionIndex}"]`);
            question.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Select current option
            const selectedOption = question.querySelectorAll('.option')[optionIndex];
            selectedOption.classList.add('selected');
            
            // Store answer
            mcAnswers[questionIndex] = answer;
        }

        function checkMultipleChoice() {
            let correct = 0;
            let total = 8;
            
            for (let i = 0; i < total; i++) {
                const question = document.querySelector(`[data-question="${i}"]`);
                const options = question.querySelectorAll('.option');
                const userAnswer = mcAnswers[i];
                const correctAnswer = correctAnswers[i];
                
                options.forEach(option => {
                    option.style.pointerEvents = 'none';
                    if (option.textContent === correctAnswer) {
                        option.classList.add('correct');
                    } else if (option.textContent === userAnswer && userAnswer !== correctAnswer) {
                        option.classList.add('incorrect');
                    }
                });
                
                if (userAnswer === correctAnswer) {
                    correct++;
                }
            }
            
            const feedback = document.getElementById('mcFeedback');
            feedback.style.display = 'block';
            if (correct === total) {
                feedback.className = 'feedback success';
                feedback.textContent = 'Doskonale! Wszystkie odpowiedzi poprawne!';
            } else {
                feedback.className = 'feedback error';
                feedback.textContent = `${correct}/${total} poprawnych. Przejrzyj zasady gramatyczne!`;
            }
            
            return correct === total;
        }

        // Task 4: Gap Fill
        function checkGapFill() {
            let correct = 0;
            let total = 8;
            
            document.querySelectorAll('.gap input').forEach(input => {
                const userAnswer = input.value.toLowerCase().trim();
                const correctAnswer = input.dataset.answer.toLowerCase();
                
                if (userAnswer === correctAnswer) {
                    input.style.backgroundColor = '#d4edda';
                    input.style.borderColor = '#28a745';
                    correct++;
                } else {
                    input.style.backgroundColor = '#f8d7da';
                    input.style.borderColor = '#dc3545';
                }
                input.readOnly = true;
            });
            
            const feedback = document.getElementById('gapFeedback');
            feedback.style.display = 'block';
            if (correct === total) {
                feedback.className = 'feedback success';
                feedback.textContent = 'Idealnie! Wszystkie luki wypełnione poprawnie!';
            } else {
                feedback.className = 'feedback error';
                feedback.textContent = `${correct}/${total} poprawnych. Sprawdź don't vs doesn't!`;
            }
            
            return correct === total;
        }

        // Task 5: Sentence Transformation
        function checkTransformation() {
            let correct = 0;
            let total = 6;
            
            document.querySelectorAll('.transform-input').forEach(input => {
                const userAnswer = input.value.toLowerCase().trim().replace(/\./g, '');
                const correctAnswer = input.dataset.answer.toLowerCase().replace(/\./g, '');
                
                if (userAnswer === correctAnswer) {
                    input.style.backgroundColor = '#d4edda';
                    input.style.borderColor = '#28a745';
                    correct++;
                } else {
                    input.style.backgroundColor = '#f8d7da';
                    input.style.borderColor = '#dc3545';
                }
                input.readOnly = true;
            });
            
            const feedback = document.getElementById('transformFeedback');
            feedback.style.display = 'block';
            if (correct === total) {
                feedback.className = 'feedback success';
                feedback.textContent = 'Doskonałe umiejętności przekształcania zdań!';
            } else {
                feedback.className = 'feedback error';
                feedback.textContent = `${correct}/${total} poprawnych. Pamiętaj: podmiot + don't/doesn't + czasownik!`;
            }
            
            return correct === total;
        }

        // Task 6: Creative Writing
        function checkWriting() {
            const text = document.getElementById('writingInput').value.trim();
            const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);
            
            let score = 0;
            let hasNegatives = 0;
            let hasVariety = false;
            
            // Check for negative forms
            sentences.forEach(sentence => {
                if (sentence.includes("don't") || sentence.includes("doesn't")) {
                    hasNegatives++;
                }
            });
            
            // Check for subject variety
            const subjects = ['I', 'you', 'he', 'she', 'it', 'we', 'they'];
            let subjectCount = 0;
            subjects.forEach(subject => {
                if (text.toLowerCase().includes(subject.toLowerCase())) {
                    subjectCount++;
                }
            });
            
            if (sentences.length >= 6) score += 25;
            if (hasNegatives >= 6) score += 25;
            if (subjectCount >= 4) score += 25;
            if (text.length > 200) score += 25;
            
            const feedback = document.getElementById('writingFeedback');
            feedback.style.display = 'block';
            
            if (score >= 75) {
                feedback.className = 'feedback success';
                feedback.textContent = `Wspaniałe twórcze pisanie! Wynik: ${score}/100. Dobrze używasz form przeczących z różnorodnością!`;
            } else {
                feedback.className = 'feedback error';
                feedback.textContent = `Wynik: ${score}/100. Spróbuj napisać więcej zdań z don't/doesn't i użyj różnych podmiotów!`;
            }
            
            return score >= 75;
        }

        // Main check function
        function checkCurrentTask() {
            let passed = false;
            
            switch(currentTask) {
                case 1:
                    passed = checkVocabulary();
                    break;
                case 2:
                    passed = checkGrammarRules();
                    if (passed) {
                        const feedback = document.getElementById('vocabFeedback');
                        feedback.style.display = 'block';
                        feedback.className = 'feedback success';
                        feedback.textContent = 'Dobrze! Poznałeś wszystkie zasady gramatyczne!';
                    }
                    break;
                case 3:
                    passed = checkMultipleChoice();
                    break;
                case 4:
                    passed = checkGapFill();
                    break;
                case 5:
                    passed = checkTransformation();
                    break;
                case 6:
                    passed = checkWriting();
                    break;
            }
            
            document.getElementById('checkBtn').disabled = true;
            document.getElementById('nextBtn').disabled = false;
        }

        function finishLesson() {
            const totalTime = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(totalTime / 60);
            const seconds = totalTime % 60;
            
            alert(`Gratulacje! Ukończyłeś wszystkie 6 zadań!\n\nCałkowity czas: ${minutes}:${seconds.toString().padStart(2, '0')}\n\nPomyślnie przećwiczyłeś:\n• Dopasowywanie słownictwa\n• Zasady gramatyczne\n• Pytania wielokrotnego wyboru\n• Wypełnianie luk\n• Przekształcanie zdań\n• Twórcze pisanie\n\nBrawo za opanowanie form przeczących Present Simple!`);
        }

        // Initialize
        updateProgress();
    </script>
</body>
</html>
