<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Dialogues Interactive Player</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .grade-section {
            margin-bottom: 30px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
        }
        .grade-title {
            font-size: 1.4em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }
        .dialogue-container {
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }
        .dialogue-header {
            background-color: #f8f9fa;
            padding: 10px 15px;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .dialogue-header:hover {
            background-color: #e9ecef;
        }
        .dialogue-header.active {
            background-color: #3498db;
            color: white;
        }
        .dialogue-title {
            font-weight: bold;
        }
        .dialogue-controls {
            display: none;
        }
        .dialogue-controls.active {
            display: block;
        }
        .control-buttons {
            padding: 10px 15px;
            background-color: #f8f9fa;
            border-top: 1px solid #ddd;
        }
        .dialogue-content {
            display: none;
            padding: 15px;
        }
        .dialogue-content.active {
            display: block;
        }
        .dialogue-line {
            margin-bottom: 8px;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            border-left: 3px solid transparent;
        }
        .dialogue-line:hover {
            background-color: #f8f9fa;
        }
        .dialogue-line.speaker-a {
            border-left-color: #3498db;
        }
        .dialogue-line.speaker-b {
            border-left-color: #e74c3c;
        }
        .dialogue-line.playing {
            background-color: #fff3cd;
            border-left-color: #ffc107;
        }
        .speaker {
            font-weight: bold;
            margin-bottom: 3px;
        }
        .speaker-a .speaker {
            color: #3498db;
        }
        .speaker-b .speaker {
            color: #e74c3c;
        }
        button {
            padding: 8px 16px;
            margin: 0 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .play-btn {
            background-color: #27ae60;
            color: white;
        }
        .play-btn:hover {
            background-color: #229954;
        }
        .pause-btn {
            background-color: #f39c12;
            color: white;
        }
        .pause-btn:hover {
            background-color: #e67e22;
        }
        .stop-btn {
            background-color: #e74c3c;
            color: white;
        }
        .stop-btn:hover {
            background-color: #c0392b;
        }
        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        .global-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: none;
        }
        .global-controls.active {
            display: block;
        }
        .status {
            margin-top: 10px;
            font-style: italic;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>English Dialogues Interactive Player</h1>
        
        <!-- Global Controls -->
        <div class="global-controls" id="global-controls">
            <div><strong>Global Controls</strong></div>
            <button class="pause-btn" id="global-pause">Pause All</button>
            <button class="stop-btn" id="global-stop">Stop All</button>
            <div class="status" id="global-status">Ready</div>
        </div>

        <!-- OCENA 2 -->
        <div class="grade-section">
            <div class="grade-title">OCENA 2 (6 questions)</div>
            
            <div class="dialogue-container" data-grade="2" data-dialogue="1">
                <div class="dialogue-header">
                    <span class="dialogue-title">Dialog 1</span>
                    <span>▶ Click to play</span>
                </div>
                <div class="dialogue-controls">
                    <div class="control-buttons">
                        <button class="play-btn">Play All</button>
                        <button class="pause-btn">Pause</button>
                        <button class="stop-btn">Stop</button>
                    </div>
                </div>
                <div class="dialogue-content">
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Are you free on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Are you free on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="I'm busy on Saturday.">
                        <div class="speaker">Person B:</div>
                        <div>I'm busy on Saturday.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Do you want to hang out on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Do you want to hang out on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="I'm sorry, I can't come.">
                        <div class="speaker">Person B:</div>
                        <div>I'm sorry, I can't come.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Would you like to hang out?">
                        <div class="speaker">Person A:</div>
                        <div>Would you like to hang out?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Sorry, maybe next time.">
                        <div class="speaker">Person B:</div>
                        <div>Sorry, maybe next time.</div>
                    </div>
                </div>
            </div>
            
            <div class="dialogue-container" data-grade="2" data-dialogue="2">
                <div class="dialogue-header">
                    <span class="dialogue-title">Dialog 2</span>
                    <span>▶ Click to play</span>
                </div>
                <div class="dialogue-controls">
                    <div class="control-buttons">
                        <button class="play-btn">Play All</button>
                        <button class="pause-btn">Pause</button>
                        <button class="stop-btn">Stop</button>
                    </div>
                </div>
                <div class="dialogue-content">
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Mum's taking us to the adventure park on Saturday. Can you come?">
                        <div class="speaker">Person A:</div>
                        <div>Mum's taking us to the adventure park on Saturday. Can you come?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="That sounds fun. Thank you.">
                        <div class="speaker">Person B:</div>
                        <div>That sounds fun. Thank you.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Are you free on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Are you free on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Yes, I'd love to, thanks.">
                        <div class="speaker">Person B:</div>
                        <div>Yes, I'd love to, thanks.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Would you like to hang out?">
                        <div class="speaker">Person A:</div>
                        <div>Would you like to hang out?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="That sounds great. Thank you.">
                        <div class="speaker">Person B:</div>
                        <div>That sounds great. Thank you.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- OCENA 3 -->
        <div class="grade-section">
            <div class="grade-title">OCENA 3 (7-8 questions)</div>
            
            <div class="dialogue-container" data-grade="3" data-dialogue="1">
                <div class="dialogue-header">
                    <span class="dialogue-title">Dialog 1</span>
                    <span>▶ Click to play</span>
                </div>
                <div class="dialogue-controls">
                    <div class="control-buttons">
                        <button class="play-btn">Play All</button>
                        <button class="pause-btn">Pause</button>
                        <button class="stop-btn">Stop</button>
                    </div>
                </div>
                <div class="dialogue-content">
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Are you free on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Are you free on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="I think so. Why?">
                        <div class="speaker">Person B:</div>
                        <div>I think so. Why?</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Would you like to hang out?">
                        <div class="speaker">Person A:</div>
                        <div>Would you like to hang out?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="That sounds fun. Thank you.">
                        <div class="speaker">Person B:</div>
                        <div>That sounds fun. Thank you.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Do you want to hang out on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Do you want to hang out on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Yes, I'd love to, thanks.">
                        <div class="speaker">Person B:</div>
                        <div>Yes, I'd love to, thanks.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Great! See you then.">
                        <div class="speaker">Person A:</div>
                        <div>Great! See you then.</div>
                    </div>
                </div>
            </div>
            
            <div class="dialogue-container" data-grade="3" data-dialogue="2">
                <div class="dialogue-header">
                    <span class="dialogue-title">Dialog 2</span>
                    <span>▶ Click to play</span>
                </div>
                <div class="dialogue-controls">
                    <div class="control-buttons">
                        <button class="play-btn">Play All</button>
                        <button class="pause-btn">Pause</button>
                        <button class="stop-btn">Stop</button>
                    </div>
                </div>
                <div class="dialogue-content">
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Mum's taking us to the adventure park on Saturday. Can you come?">
                        <div class="speaker">Person A:</div>
                        <div>Mum's taking us to the adventure park on Saturday. Can you come?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="I'd love to, but we're visiting our cousins this Saturday.">
                        <div class="speaker">Person B:</div>
                        <div>I'd love to, but we're visiting our cousins this Saturday.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="That's too bad.">
                        <div class="speaker">Person A:</div>
                        <div>That's too bad.</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Sorry, maybe next time.">
                        <div class="speaker">Person B:</div>
                        <div>Sorry, maybe next time.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Are you free on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Are you free on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Yes! Sunday is good.">
                        <div class="speaker">Person B:</div>
                        <div>Yes! Sunday is good.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Would you like to hang out then?">
                        <div class="speaker">Person A:</div>
                        <div>Would you like to hang out then?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="That sounds great. Thank you.">
                        <div class="speaker">Person B:</div>
                        <div>That sounds great. Thank you.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- OCENA 4 -->
        <div class="grade-section">
            <div class="grade-title">OCENA 4 (9-10 questions)</div>
            
            <div class="dialogue-container" data-grade="4" data-dialogue="1">
                <div class="dialogue-header">
                    <span class="dialogue-title">Dialog 1</span>
                    <span>▶ Click to play</span>
                </div>
                <div class="dialogue-controls">
                    <div class="control-buttons">
                        <button class="play-btn">Play All</button>
                        <button class="pause-btn">Pause</button>
                        <button class="stop-btn">Stop</button>
                    </div>
                </div>
                <div class="dialogue-content">
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Are you free on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Are you free on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="I'm busy on Saturday.">
                        <div class="speaker">Person B:</div>
                        <div>I'm busy on Saturday.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="I said Sunday, not Saturday.">
                        <div class="speaker">Person A:</div>
                        <div>I said Sunday, not Saturday.</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Oh, sorry! Yes, I think so.">
                        <div class="speaker">Person B:</div>
                        <div>Oh, sorry! Yes, I think so.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Would you like to hang out?">
                        <div class="speaker">Person A:</div>
                        <div>Would you like to hang out?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="That sounds fun. Thank you.">
                        <div class="speaker">Person B:</div>
                        <div>That sounds fun. Thank you.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Great! What time?">
                        <div class="speaker">Person A:</div>
                        <div>Great! What time?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="How about 2 PM?">
                        <div class="speaker">Person B:</div>
                        <div>How about 2 PM?</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Perfect! Do you want to hang out on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Perfect! Do you want to hang out on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Yes, I'd love to, thanks.">
                        <div class="speaker">Person B:</div>
                        <div>Yes, I'd love to, thanks.</div>
                    </div>
                </div>
            </div>
            
            <div class="dialogue-container" data-grade="4" data-dialogue="2">
                <div class="dialogue-header">
                    <span class="dialogue-title">Dialog 2</span>
                    <span>▶ Click to play</span>
                </div>
                <div class="dialogue-controls">
                    <div class="control-buttons">
                        <button class="play-btn">Play All</button>
                        <button class="pause-btn">Pause</button>
                        <button class="stop-btn">Stop</button>
                    </div>
                </div>
                <div class="dialogue-content">
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Mum's taking us to the adventure park on Saturday. Can you come?">
                        <div class="speaker">Person A:</div>
                        <div>Mum's taking us to the adventure park on Saturday. Can you come?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="I'd love to, but we're visiting our cousins this Saturday.">
                        <div class="speaker">Person B:</div>
                        <div>I'd love to, but we're visiting our cousins this Saturday.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="What about Sunday then?">
                        <div class="speaker">Person A:</div>
                        <div>What about Sunday then?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Sunday? Let me think.">
                        <div class="speaker">Person B:</div>
                        <div>Sunday? Let me think.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Are you free on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Are you free on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Yes! Sunday is much better.">
                        <div class="speaker">Person B:</div>
                        <div>Yes! Sunday is much better.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Would you like to hang out then?">
                        <div class="speaker">Person A:</div>
                        <div>Would you like to hang out then?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="That sounds great. Thank you.">
                        <div class="speaker">Person B:</div>
                        <div>That sounds great. Thank you.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Do you want to hang out on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Do you want to hang out on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Yes, I'd love to, thanks.">
                        <div class="speaker">Person B:</div>
                        <div>Yes, I'd love to, thanks.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- OCENA 5 -->
        <div class="grade-section">
            <div class="grade-title">OCENA 5 (11-12 questions)</div>
            
            <div class="dialogue-container" data-grade="5" data-dialogue="1">
                <div class="dialogue-header">
                    <span class="dialogue-title">Dialog 1</span>
                    <span>▶ Click to play</span>
                </div>
                <div class="dialogue-controls">
                    <div class="control-buttons">
                        <button class="play-btn">Play All</button>
                        <button class="pause-btn">Pause</button>
                        <button class="stop-btn">Stop</button>
                    </div>
                </div>
                <div class="dialogue-content">
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Hi! Are you free on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Hi! Are you free on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Yes, I think so. Why?">
                        <div class="speaker">Person B:</div>
                        <div>Yes, I think so. Why?</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Would you like to hang out?">
                        <div class="speaker">Person A:</div>
                        <div>Would you like to hang out?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="That sounds fun. Thank you.">
                        <div class="speaker">Person B:</div>
                        <div>That sounds fun. Thank you.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Great! What time?">
                        <div class="speaker">Person A:</div>
                        <div>Great! What time?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="How about 2 PM?">
                        <div class="speaker">Person B:</div>
                        <div>How about 2 PM?</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Perfect! Do you want to hang out on Sunday at the park?">
                        <div class="speaker">Person A:</div>
                        <div>Perfect! Do you want to hang out on Sunday at the park?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Yes, I'd love to, thanks.">
                        <div class="speaker">Person B:</div>
                        <div>Yes, I'd love to, thanks.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="We can have lunch there.">
                        <div class="speaker">Person A:</div>
                        <div>We can have lunch there.</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="That sounds great. Thank you.">
                        <div class="speaker">Person B:</div>
                        <div>That sounds great. Thank you.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="What should I bring?">
                        <div class="speaker">Person A:</div>
                        <div>What should I bring?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Nothing special. Maybe some drinks.">
                        <div class="speaker">Person B:</div>
                        <div>Nothing special. Maybe some drinks.</div>
                    </div>
                </div>
            </div>
            
            <div class="dialogue-container" data-grade="5" data-dialogue="2">
                <div class="dialogue-header">
                    <span class="dialogue-title">Dialog 2</span>
                    <span>▶ Click to play</span>
                </div>
                <div class="dialogue-controls">
                    <div class="control-buttons">
                        <button class="play-btn">Play All</button>
                        <button class="pause-btn">Pause</button>
                        <button class="stop-btn">Stop</button>
                    </div>
                </div>
                <div class="dialogue-content">
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Mum's taking us to the adventure park on Saturday. Can you come?">
                        <div class="speaker">Person A:</div>
                        <div>Mum's taking us to the adventure park on Saturday. Can you come?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="I'd love to, but we're visiting our cousins this Saturday.">
                        <div class="speaker">Person B:</div>
                        <div>I'd love to, but we're visiting our cousins this Saturday.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="That's too bad. When are you free?">
                        <div class="speaker">Person A:</div>
                        <div>That's too bad. When are you free?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="I'm sorry, I can't come this weekend.">
                        <div class="speaker">Person B:</div>
                        <div>I'm sorry, I can't come this weekend.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Really? What about Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Really? What about Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Actually, yes! Sunday is good.">
                        <div class="speaker">Person B:</div>
                        <div>Actually, yes! Sunday is good.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Great! Would you like to hang out then?">
                        <div class="speaker">Person A:</div>
                        <div>Great! Would you like to hang out then?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="That sounds great. Thank you.">
                        <div class="speaker">Person B:</div>
                        <div>That sounds great. Thank you.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="We can do something else instead.">
                        <div class="speaker">Person A:</div>
                        <div>We can do something else instead.</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Yes, that's fine.">
                        <div class="speaker">Person B:</div>
                        <div>Yes, that's fine.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Do you want to hang out on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Do you want to hang out on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Yes, I'd love to, thanks.">
                        <div class="speaker">Person B:</div>
                        <div>Yes, I'd love to, thanks.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- OCENA 6 -->
        <div class="grade-section">
            <div class="grade-title">OCENA 6 (13+ questions)</div>
            
            <div class="dialogue-container" data-grade="6" data-dialogue="1">
                <div class="dialogue-header">
                    <span class="dialogue-title">Dialog 1</span>
                    <span>▶ Click to play</span>
                </div>
                <div class="dialogue-controls">
                    <div class="control-buttons">
                        <button class="play-btn">Play All</button>
                        <button class="pause-btn">Pause</button>
                        <button class="stop-btn">Stop</button>
                    </div>
                </div>
                <div class="dialogue-content">
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Hi! Are you free on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Hi! Are you free on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Let me think... Yes, I am. What do you want to do?">
                        <div class="speaker">Person B:</div>
                        <div>Let me think... Yes, I am. What do you want to do?</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Would you like to hang out?">
                        <div class="speaker">Person A:</div>
                        <div>Would you like to hang out?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="That sounds fun. Thank you!">
                        <div class="speaker">Person B:</div>
                        <div>That sounds fun. Thank you!</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Great! What time?">
                        <div class="speaker">Person A:</div>
                        <div>Great! What time?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="How about 12 o'clock?">
                        <div class="speaker">Person B:</div>
                        <div>How about 12 o'clock?</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Perfect! Do you want to hang out on Sunday at the park?">
                        <div class="speaker">Person A:</div>
                        <div>Perfect! Do you want to hang out on Sunday at the park?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Yes, I'd love to, thanks. What time?">
                        <div class="speaker">Person B:</div>
                        <div>Yes, I'd love to, thanks. What time?</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="12 o'clock is good. We can have lunch there.">
                        <div class="speaker">Person A:</div>
                        <div>12 o'clock is good. We can have lunch there.</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="That sounds great. Thank you. What should I bring?">
                        <div class="speaker">Person B:</div>
                        <div>That sounds great. Thank you. What should I bring?</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Nothing special. Maybe some drinks.">
                        <div class="speaker">Person A:</div>
                        <div>Nothing special. Maybe some drinks.</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="OK! Should we meet at the main gate?">
                        <div class="speaker">Person B:</div>
                        <div>OK! Should we meet at the main gate?</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Yes, that's perfect.">
                        <div class="speaker">Person A:</div>
                        <div>Yes, that's perfect.</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Great! See you on Sunday then.">
                        <div class="speaker">Person B:</div>
                        <div>Great! See you on Sunday then.</div>
                    </div>
                </div>
            </div>
            
            <div class="dialogue-container" data-grade="6" data-dialogue="2">
                <div class="dialogue-header">
                    <span class="dialogue-title">Dialog 2</span>
                    <span>▶ Click to play</span>
                </div>
                <div class="dialogue-controls">
                    <div class="control-buttons">
                        <button class="play-btn">Play All</button>
                        <button class="pause-btn">Pause</button>
                        <button class="stop-btn">Stop</button>
                    </div>
                </div>
                <div class="dialogue-content">
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Mum's taking us to the adventure park on Saturday. Can you come?">
                        <div class="speaker">Person A:</div>
                        <div>Mum's taking us to the adventure park on Saturday. Can you come?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Oh, I'd love to, but we're visiting our cousins this Saturday.">
                        <div class="speaker">Person B:</div>
                        <div>Oh, I'd love to, but we're visiting our cousins this Saturday.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Really? That's too bad. I wanted to go with you.">
                        <div class="speaker">Person A:</div>
                        <div>Really? That's too bad. I wanted to go with you.</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="I'm sorry, I can't come. When did you plan this?">
                        <div class="speaker">Person B:</div>
                        <div>I'm sorry, I can't come. When did you plan this?</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Just yesterday. Are you free on Sunday?">
                        <div class="speaker">Person A:</div>
                        <div>Just yesterday. Are you free on Sunday?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Sunday? Let me check...">
                        <div class="speaker">Person B:</div>
                        <div>Sunday? Let me check...</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Take your time.">
                        <div class="speaker">Person A:</div>
                        <div>Take your time.</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Yes! Sunday is much better.">
                        <div class="speaker">Person B:</div>
                        <div>Yes! Sunday is much better.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Great! Would you like to hang out then?">
                        <div class="speaker">Person A:</div>
                        <div>Great! Would you like to hang out then?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="That sounds great. Thank you for changing the plan.">
                        <div class="speaker">Person B:</div>
                        <div>That sounds great. Thank you for changing the plan.</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="We can do something else instead.">
                        <div class="speaker">Person A:</div>
                        <div>We can do something else instead.</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="What do you have in mind?">
                        <div class="speaker">Person B:</div>
                        <div>What do you have in mind?</div>
                    </div>
                    <div class="dialogue-line speaker-a" data-speaker="A" data-text="Do you want to hang out on Sunday at the shopping center?">
                        <div class="speaker">Person A:</div>
                        <div>Do you want to hang out on Sunday at the shopping center?</div>
                    </div>
                    <div class="dialogue-line speaker-b" data-speaker="B" data-text="Yes, I'd love to, thanks. What time?">
                        <div class="speaker">Person B:</div>
                        <div>Yes, I'd love to, thanks. What time?</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

   <script>
    document.addEventListener('DOMContentLoaded', () => {
        if (!('speechSynthesis' in window)) {
            alert("Niestety, Twoja przeglądarka nie wspiera syntezy mowy. Funkcje audio nie będą działać.");
            document.querySelectorAll('button.play-btn, button.pause-btn, button.stop-btn, .global-controls').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.dialogue-header span:nth-child(2)').forEach(el => el.style.display = 'none');
            return;
        }

        const synth = window.speechSynthesis;
        let voices = [];
        let speakerA, speakerB;
        let currentDialogue = null;
        let currentLineIndex = 0;
        let isPlaying = false; // Czy trwa odtwarzanie sekwencji linii w currentDialogue
        let isPaused = false;  // Czy synteza mowy jest globalnie wstrzymana (synth.paused)

        const globalControls = document.getElementById('global-controls');
        const globalPauseBtn = document.getElementById('global-pause');
        const globalStopBtn = document.getElementById('global-stop');
        const globalStatus = document.getElementById('global-status');

        function initVoices() {
            voices = synth.getVoices();
            const englishVoices = voices.filter(voice => voice.lang.startsWith('en'));
            
            speakerA = englishVoices.find(voice => voice.name.toLowerCase().includes('male')) || 
                       voices.find(voice => voice.lang.startsWith('en') && voice.name.toLowerCase().includes('male')) ||
                       englishVoices[0] || voices.find(v => v.lang.startsWith('en'));
            
            speakerB = englishVoices.find(voice => voice.name.toLowerCase().includes('eva') || voice.name.toLowerCase().includes('female')) ||
                       voices.find(voice => voice.lang.startsWith('en') && voice.name.toLowerCase().includes('female')) ||
                       englishVoices[1] || voices.find(v => v.lang.startsWith('en') && v !== speakerA);

            if (!speakerA && voices.length > 0) speakerA = voices[0];
            if (!speakerB && voices.length > 0) speakerB = (voices.length > 1 ? voices[1] : voices[0]);
            
            // console.log('Selected voices:', { A: speakerA?.name, B: speakerB?.name });
            if (!speakerA || !speakerB) {
                console.warn("Nie udało się załadować preferowanych głosów. Jakość audio może być niższa.");
                if (voices.length > 0 && !speakerA) speakerA = voices[0];
                if (voices.length > 0 && !speakerB) speakerB = voices[voices.length > 1 ? 1 : 0];
            }
        }

        if (synth.onvoiceschanged !== undefined) {
            synth.onvoiceschanged = initVoices;
        }
        initVoices(); // Wywołaj raz na starcie, na wypadek gdyby głosy były już dostępne

        function clearAllPlayingStatesExcept(keepActiveDialogueContainer) {
            document.querySelectorAll('.dialogue-line.playing').forEach(line => {
                line.classList.remove('playing');
            });
            document.querySelectorAll('.dialogue-container').forEach(dc => {
                if (dc !== keepActiveDialogueContainer) {
                    dc.querySelector('.dialogue-header')?.classList.remove('active');
                    dc.querySelector('.dialogue-content')?.classList.remove('active');
                    dc.querySelector('.dialogue-controls')?.classList.remove('active');
                    const localPauseBtn = dc.querySelector('.dialogue-controls .pause-btn');
                    if (localPauseBtn) localPauseBtn.textContent = 'Pause';
                }
            });
        }
        
        function activateDialogueUI(dialogueContainer) {
            dialogueContainer.querySelector('.dialogue-header')?.classList.add('active');
            dialogueContainer.querySelector('.dialogue-content')?.classList.add('active');
            dialogueContainer.querySelector('.dialogue-controls')?.classList.add('active');
            currentDialogue = dialogueContainer; // Ustaw jako aktywny
        }


        function playSingleLine(lineElement) {
            const dialogueContainerOfLine = lineElement.closest('.dialogue-container');
            if (!dialogueContainerOfLine) return;

            synth.cancel(); // Anuluj poprzednie mowy - to może wywołać 'interrupted' error dla nich
            isPlaying = false; 
            isPaused = false;  

            clearAllPlayingStatesExcept(dialogueContainerOfLine);
            activateDialogueUI(dialogueContainerOfLine);
            
            lineElement.classList.add('playing');

            const text = lineElement.getAttribute('data-text');
            const speaker = lineElement.getAttribute('data-speaker');
            const voice = speaker === 'A' ? speakerA : speakerB;

            const utterance = new SpeechSynthesisUtterance(text);
            if (voice) utterance.voice = voice;
            utterance.rate = 0.9;

            globalControls.classList.add('active');
            globalPauseBtn.textContent = 'Pause All'; 
            updateGlobalStatus(`Odtwarzanie (1 linia): ${speaker} - "${text.substring(0, 30)}..."`);

            utterance.onend = () => {
                lineElement.classList.remove('playing');
                if (currentDialogue === dialogueContainerOfLine && !isPlaying && !synth.speaking) {
                     updateGlobalStatus(`${dialogueContainerOfLine.querySelector('.dialogue-title').textContent} aktywny.`);
                }
            };

            utterance.onerror = (e) => {
                const context = "playSingleLine";
                if (e.error === 'interrupted') {
                    console.log(`Mowa przerwana (oczekiwane) [${context}]: "${e.utterance.text.substring(0,30)}..."`);
                } else {
                    console.error(`Błąd syntezy mowy [${context}]: ${e.error}, Text: "${e.utterance.text.substring(0,30)}..."`);
                    updateGlobalStatus('Wystąpił błąd odtwarzania.');
                }
                lineElement.classList.remove('playing');
            };

            synth.speak(utterance);
        }

        function playDialogue(dialogueContainer) {
            synth.cancel(); // Anuluj poprzednie - to może wywołać 'interrupted' error dla nich
            
            if (currentDialogue === dialogueContainer && isPlaying && isPaused) {
                resumeDialogue();
                return;
            }

            clearAllPlayingStatesExcept(dialogueContainer);
            activateDialogueUI(dialogueContainer);
            
            currentLineIndex = 0;
            isPlaying = true;
            isPaused = false;

            const localPauseBtn = dialogueContainer.querySelector('.dialogue-controls .pause-btn');
            if (localPauseBtn) localPauseBtn.textContent = 'Pause';

            globalControls.classList.add('active');
            globalPauseBtn.textContent = 'Pause All';
            
            playNextLine();
        }

        function playNextLine() {
            if (!currentDialogue || !isPlaying || isPaused) return;

            const lines = currentDialogue.querySelectorAll('.dialogue-line');
            document.querySelectorAll('.dialogue-line.playing').forEach(l => l.classList.remove('playing')); // Usuń z poprzednich
            
            if (currentLineIndex >= lines.length) {
                isPlaying = false;
                updateGlobalStatus(`Dialog zakończony: ${currentDialogue.querySelector('.dialogue-title').textContent}.`);
                return;
            }

            const lineElement = lines[currentLineIndex];
            const text = lineElement.getAttribute('data-text');
            const speaker = lineElement.getAttribute('data-speaker');
            const voice = speaker === 'A' ? speakerA : speakerB;

            lineElement.classList.add('playing');

            const utterance = new SpeechSynthesisUtterance(text);
            if (voice) utterance.voice = voice;
            utterance.rate = 0.9;

            updateGlobalStatus(`Odtwarzanie dialogu: ${speaker} (${currentLineIndex + 1}/${lines.length})`);

            utterance.onend = () => {
                lineElement.classList.remove('playing');
                if (isPlaying && !isPaused) { // Upewnij się, że nadal powinniśmy grać
                    currentLineIndex++;
                    setTimeout(() => playNextLine(), 500);
                }
            };

            utterance.onerror = (e) => {
                const context = "playNextLine";
                lineElement.classList.remove('playing'); // Zawsze usuń klasę 'playing' z linii, która spowodowała błąd

                if (e.error === 'interrupted') {
                    console.log(`Mowa przerwana (oczekiwane) [${context}]: "${e.utterance.text.substring(0,30)}..."`);
                    // Jeśli mowa została przerwana, to znaczy, że użytkownik zainicjował inną akcję
                    // (np. stop, play single, play another dialogue).
                    // Funkcje te (stopDialogue, playSingleLine, playDialogue) same zarządzają stanem isPlaying.
                    // Dlatego tutaj nie powinniśmy automatycznie przechodzić do następnej linii.
                } else {
                    console.error(`Błąd syntezy mowy [${context}]: ${e.error}, Text: "${e.utterance.text.substring(0,30)}..."`);
                    updateGlobalStatus('Błąd podczas odtwarzania dialogu.');
                    
                    // Spróbuj przejść do następnej linii tylko jeśli błąd NIE był przerwaniem
                    // i nadal jesteśmy w trybie odtwarzania tego samego dialogu.
                    if (isPlaying && currentDialogue && currentDialogue.contains(lineElement) && !isPaused) {
                        console.warn("Nieoczekiwany błąd, próba przejścia do następnej linii.");
                        currentLineIndex++;
                        setTimeout(() => playNextLine(), 500);
                    }
                }
            };
            synth.speak(utterance);
        }

        function pauseDialogue() {
            if (synth.speaking && !synth.paused) {
                synth.pause();
                isPaused = true;
                updateGlobalStatus('Pauza');
                globalPauseBtn.textContent = 'Resume All';
                if (currentDialogue) {
                    const localPauseBtn = currentDialogue.querySelector('.dialogue-controls .pause-btn');
                    if (localPauseBtn) localPauseBtn.textContent = 'Resume';
                }
            }
        }

        function resumeDialogue() {
            if (synth.paused) {
                synth.resume();
                isPaused = false; // isPaused jest teraz false
                
                globalPauseBtn.textContent = 'Pause All';
                if (currentDialogue) {
                    const localPauseBtn = currentDialogue.querySelector('.dialogue-controls .pause-btn');
                    if (localPauseBtn) localPauseBtn.textContent = 'Pause';

                    // Zaktualizuj status na podstawie tego, co było odtwarzane
                    if (isPlaying) { // Jeśli odtwarzano sekwencję
                         const lines = currentDialogue.querySelectorAll('.dialogue-line');
                         if (currentLineIndex < lines.length) {
                            const lineElement = lines[currentLineIndex];
                            const speaker = lineElement.getAttribute('data-speaker');
                            updateGlobalStatus(`Wznowiono dialog: ${speaker} (${currentLineIndex + 1}/${lines.length})`);
                         }
                         // playNextLine jest wywoływane przez onend poprzedniego utterance jeśli nie było pauzy,
                         // ale po resume, jeśli utterance nie zakończyło się, będzie kontynuować i jego onend wywoła playNextLine.
                         // Jeśli utterance skończyło się podczas pauzy (mało prawdopodobne), onend mogło nie odpalić playNextLine.
                         // Dla pewności można by wywołać playNextLine, jeśli isPlaying i !synth.speaking, ale to skomplikowane.
                         // Zazwyczaj resume() po prostu kontynuuje bieżący utterance.
                    } else { // Jeśli odtwarzano pojedynczą linię (lub nic aktywnego w sekwencji)
                        const playingLine = currentDialogue.querySelector('.dialogue-line.playing');
                        if (playingLine) {
                            const text = playingLine.getAttribute('data-text');
                            const speaker = playingLine.getAttribute('data-speaker');
                            updateGlobalStatus(`Wznowiono (1 linia): ${speaker} - "${text.substring(0, 30)}..."`);
                        } else {
                             updateGlobalStatus(`Wznowiono. ${currentDialogue.querySelector('.dialogue-title').textContent} aktywny.`);
                        }
                    }
                } else {
                    updateGlobalStatus('Wznowiono');
                }
            }
        }

        function stopDialogue() {
            synth.cancel(); // To może wywołać 'interrupted' error dla bieżącej mowy
            isPlaying = false;
            isPaused = false;

            if (currentDialogue) {
                const localPauseBtn = currentDialogue.querySelector('.dialogue-controls .pause-btn');
                if (localPauseBtn) localPauseBtn.textContent = 'Pause';
                // Nie usuwaj currentDialogue, dialog może pozostać "otwarty" ale nie grający
                // currentDialogue = null; // Decyzja: czy stop ma też "zamknąć" aktywny dialog?
            }
            // Usuń wszystkie aktywne stany wizualne, bo wszystko zostało zatrzymane
             document.querySelectorAll('.dialogue-line.playing').forEach(line => line.classList.remove('playing'));
             // Pozostawienie kontrolek dialogu otwartego, jeśli taki był:
             // clearAllPlayingStatesExcept(currentDialogue); // Jeśli chcemy zostawić otwarty ale nie grający
             // Jeśli stop ma zwinąć wszystko:
             clearAllPlayingStatesExcept(null); 
             currentDialogue = null;


            globalControls.classList.remove('active');
            updateGlobalStatus('Zatrzymano. Gotowy.');
            globalPauseBtn.textContent = 'Pause All';
        }
        
        function updateGlobalStatus(message) {
            if (globalStatus) {
                globalStatus.textContent = message;
            }
        }

        // Event Listeners
        document.querySelectorAll('.dialogue-header').forEach(header => {
            header.addEventListener('click', (e) => {
                const dialogueContainer = header.closest('.dialogue-container');
                if (currentDialogue === dialogueContainer && isPlaying) { // Kliknięcie aktywnego, grającego dialogu
                    if (isPaused) {
                        resumeDialogue();
                    } else {
                        pauseDialogue();
                    }
                } else { // Inny dialog lub ten sam, ale nie grający aktywnie sekwencji
                    playDialogue(dialogueContainer);
                }
            });
        });

        document.querySelectorAll('.dialogue-line').forEach(line => {
            line.addEventListener('click', (e) => {
                e.stopPropagation(); 
                playSingleLine(line);
            });
        });

        document.querySelectorAll('.dialogue-controls .play-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                const dialogueContainer = btn.closest('.dialogue-container');
                playDialogue(dialogueContainer);
            });
        });

        document.querySelectorAll('.dialogue-controls .pause-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                const dialogueContainer = btn.closest('.dialogue-container');
                // Przycisk pauzy działa tylko jeśli ten dialog jest aktualnie odtwarzany lub pauzowany
                if (currentDialogue === dialogueContainer && (synth.speaking || synth.paused)) {
                    if (isPaused) { // lub synth.paused
                        resumeDialogue();
                    } else {
                        pauseDialogue();
                    }
                } else if (currentDialogue === dialogueContainer && !synth.speaking && !synth.paused){
                    // Jeśli dialog jest aktywny, ale nic nie gra (np. skończył lub błąd), 'Play All' jest lepszą opcją
                    playDialogue(dialogueContainer);
                }
            });
        });

        document.querySelectorAll('.dialogue-controls .stop-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                const dialogueContainer = btn.closest('.dialogue-container');
                // Stop działa globalnie, ale można by go ograniczyć do aktywnego dialogu
                // if (currentDialogue === dialogueContainer) {
                    stopDialogue();
                // }
            });
        });

        globalPauseBtn.addEventListener('click', () => {
             if (synth.speaking || synth.paused) { // Działaj, jeśli coś się odtwarza lub jest spauzowane
                if (isPaused) { // synth.paused
                    resumeDialogue();
                } else {
                    pauseDialogue();
                }
            }
        });

        globalStopBtn.addEventListener('click', () => {
            stopDialogue();
        });
    });
</script>
</body>
</html>
