<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Angielski dla Dzieci: Pory Dnia, Dni Tygodnia, Czas, Liczby i Czynności</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Bubblegum+Sans&display=swap');
        
        :root {
            --primary: #FF6B6B; /* Czerwono-różowy */
            --secondary: #4ECDC4; /* Turkusowy */
            --accent1: #FFE66D; /* Żółty */
            --accent2: #7868E6; /* Fioletowy */
            --accent3: #B8F2E6; /* Jasny miętowy */
            --accent4: #FFA5AB; /* Jasny różowy */
            --accent5: #FFD166; /* Pomarańczowo-żółty (Przysłówki) */
            --accent6: #AED9E0; /* Jasny niebieski (Liczby) */
            --accent7: #A0C4FF; /* Jasniejszy niebieski (Wisielec) */
            --bg-light: #FAFEFF;
            --text-dark: #333333;
            --card-shadow: 0 8px 15px rgba(0,0,0,0.1);
            --correct-color: #4CAF50; /* Zielony - sukces */
            --incorrect-color: #F44336; /* Czerwony - błąd */
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Comic Neue', cursive;
            background-color: var(--bg-light);
            color: var(--text-dark);
            overflow-x: hidden;
        }
        
        h1, h2, h3, h4 {
            font-family: 'Bubblegum Sans', cursive;
        }
        
        .header {
            background-color: var(--primary);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
        }
        
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; position: relative; z-index: 2; }
        .header p { font-size: 1.2rem; position: relative; z-index: 2; }
        
        .header::before { /* Clock SVG */
             content: ""; position: absolute; width: 150px; height: 150px;
             background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="rgba(255,255,255,0.2)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg>');
             background-repeat: no-repeat; background-size: contain; top: 10px; right: 30px; opacity: 0.6; z-index: 1;
        }
        
        /* --- Dashboard --- */
        .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; padding: 30px; max-width: 1700px; margin: 0 auto; }
        .module-card { background-color: white; border-radius: 20px; padding: 25px; box-shadow: var(--card-shadow); transition: all 0.3s ease; position: relative; overflow: hidden; cursor: pointer; min-height: 200px; display: flex; flex-direction: column; }
        .module-card:hover { transform: translateY(-10px); box-shadow: 0 15px 25px rgba(0,0,0,0.15); }
        
        /* Module Background Colors */
        .module-card.time-module { background-color: var(--secondary); color: white; }
        .module-card.days-module { background-color: var(--accent1); }
        .module-card.clock-module { background-color: var(--accent2); color: white; }
        .module-card.numbers-module { background-color: var(--accent6); } /* NEW */
        .module-card.present-simple-module { background-color: var(--accent3); }
        .module-card.adverbs-module { background-color: var(--accent5); }
        .module-card.vocabulary-module { background-color: var(--accent4); }
        .module-card.hangman-module { background-color: var(--accent7); } /* NEW */
        
        .module-icon { width: 80px; height: 80px; background-color: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; }
        .module-icon i { font-size: 2.5rem; color: white; }
        
        /* Adjust icon color for light backgrounds */
        .days-module .module-icon i, .present-simple-module .module-icon i, .adverbs-module .module-icon i, .numbers-module .module-icon i, .hangman-module .module-icon i { color: var(--text-dark); }
        
        .module-title { font-size: 1.5rem; margin-bottom: 15px; }
        .module-description { font-size: 1rem; margin-bottom: 20px; flex-grow: 1; }
        .module-badge { position: absolute; top: 15px; right: 15px; background-color: white; color: var(--text-dark); border-radius: 25px; padding: 5px 10px; font-size: 0.8rem; font-weight: bold; display: flex; align-items: center; gap: 5px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .progress-container { width: 100%; height: 10px; background-color: rgba(255,255,255,0.3); border-radius: 10px; overflow: hidden; margin-top: auto; }
        .progress-bar { height: 100%; width: 0%; border-radius: 10px; background-color: white; transition: width 0.3s ease; }
        
        /* Adjust progress bar color for light backgrounds */
        .days-module .progress-bar, .present-simple-module .progress-bar, .adverbs-module .progress-bar, .numbers-module .progress-bar, .hangman-module .progress-bar { background-color: var(--text-dark); }
        
        /* --- Section Content Styling --- */
        .section-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--bg-light); z-index: 100; display: none; overflow-y: auto; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        .section-header { padding: 20px; display: flex; justify-content: space-between; align-items: center; background-color: inherit; position: sticky; top: 0; z-index: 10; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        
        /* Section Specific Header Colors */
        .time-section .section-header { background-color: var(--secondary); color: white; }
        .days-section .section-header { background-color: var(--accent1); }
        .clock-section .section-header { background-color: var(--accent2); color: white; }
        .numbers-section .section-header { background-color: var(--accent6); } /* NEW */
        .present-simple-section .section-header { background-color: var(--accent3); }
        .adverbs-section .section-header { background-color: var(--accent5); }
        .vocabulary-section .section-header { background-color: var(--accent4); }
        .hangman-section .section-header { background-color: var(--accent7); } /* NEW */
        
        .section-title { font-size: 1.8rem; margin: 0; }
        .back-button { background: none; border: none; color: inherit; font-size: 1.3rem; cursor: pointer; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: background-color 0.3s ease; margin-right: 10px; }
        .back-button:hover { background-color: rgba(255,255,255,0.2); }
        .section-content { padding: 20px 30px 40px; }
        
        .explanation-card { background-color: white; border-radius: 15px; padding: 20px; margin-bottom: 30px; box-shadow: var(--card-shadow); }
        .explanation-card h3 { font-size: 1.3rem; margin-bottom: 15px; color: var(--primary); }
        .explanation-examples { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 20px; }
        .example-item { background-color: var(--accent3); border-radius: 10px; padding: 8px 12px; font-size: 0.95rem; }
        
        .exercise-card { background-color: white; border-radius: 15px; padding: 20px; margin-bottom: 20px; box-shadow: var(--card-shadow); }
        .exercise-card h3 { font-size: 1.3rem; margin-bottom: 15px; color: var(--accent2); }
        .exercise { margin-bottom: 25px; padding-bottom: 20px; border-bottom: 2px dashed #eee; }
        .exercise:last-child { border-bottom: none; padding-bottom: 0; }
        .exercise-question { font-size: 1.1rem; margin-bottom: 15px; font-weight: bold; }
        
        /* Multiple Choice Options */
        .options-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 15px; }
        .option-item { background-color: #f5f5f5; border: 2px solid #ddd; border-radius: 10px; padding: 12px; cursor: pointer; text-align: center; transition: all 0.2s ease; font-size: 1rem; }
        .option-item:hover { background-color: #eaeaea; transform: translateY(-3px); }
        .option-item.selected { background-color: var(--accent2); color: white; border-color: var(--accent2); }
        .option-item.correct { background-color: var(--correct-color); color: white; border-color: var(--correct-color); }
        .option-item.incorrect { background-color: var(--incorrect-color); color: white; border-color: var(--incorrect-color); }
        
        /* Numbers Grid */
        .numbers-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px; text-align: center; margin-top: 15px;}
        .number-item { background-color: #f9f9f9; padding: 10px; border-radius: 8px; border: 1px solid #eee; }
        .number-item strong { color: var(--accent2); display: block; margin-bottom: 5px; font-size: 1.1rem;}
        
        /* Writing Exercise (Fill-in-the-Blanks) */
        .writing-exercise { margin-top: 30px; padding-top: 20px; border-top: 3px solid #eee; background-color: #f9f9fa; padding: 20px; border-radius: 10px; }
        .writing-exercise h4 { margin-bottom: 15px; color: var(--accent2); font-size: 1.2rem; }
        .writing-exercise p { margin-bottom: 15px; line-height: 1.8; font-size: 1.1rem; }
        .fill-blank { padding: 6px 10px; margin: 0 3px; border: 2px solid #ccc; border-radius: 6px; font-family: 'Comic Neue', cursive; font-size: 1rem; outline: none; transition: all 0.2s ease; min-width: 80px; }
        .fill-blank:focus { border-color: var(--accent2); box-shadow: 0 0 0 3px rgba(120, 104, 230, 0.3); }
        .fill-blank.correct { border-color: var(--correct-color); background-color: rgba(76, 175, 80, 0.1); }
        .fill-blank.incorrect { border-color: var(--incorrect-color); background-color: rgba(244, 67, 54, 0.1); }
        
        /* Check Button */
        .check-button { background-color: var(--accent2); color: white; border: none; border-radius: 10px; padding: 12px 20px; font-family: 'Bubblegum Sans', cursive; font-size: 1.1rem; cursor: pointer; display: block; margin: 20px auto; transition: all 0.3s ease; }
        .check-button:hover { background-color: #6659d4; transform: scale(1.05); }
        
        /* --- Hangman Specific Styles (Integrated) --- */
        .hangman-container { text-align: center; padding: 20px; }
        .hangman-setup-section, .hangman-game-section { margin: 20px 0; }
        .hangman-category-buttons button, .hangman-attempts-selector button {
            background-color: var(--accent2); color: white; border: none; padding: 10px 15px; margin: 5px; border-radius: 8px; cursor: pointer; font-family: 'Bubblegum Sans', cursive; font-size: 1rem;
        }
        .hangman-category-buttons button:hover, .hangman-attempts-selector button:hover { background-color: #6659d4; }
        .hangman-category-buttons button.active, .hangman-attempts-selector button.active { background-color: var(--primary); font-weight: bold; }
        
        .hangman-game-section.hidden { display: none; }
        #hangmanCanvas { border: 2px solid #ccc; border-radius: 5px; margin: 20px auto; display: block; background-color: white; }
        .hangman-word-display { font-size: 2rem; letter-spacing: 8px; margin: 25px 0; font-family: monospace; min-height: 40px; padding: 10px; border-bottom: 3px solid var(--accent7); display: inline-block; }
        .hangman-hint { font-size: 1.1rem; color: var(--accent2); margin: 15px 0; font-style: italic; min-height: 24px; }
        .hangman-attempts { font-size: 1.1rem; font-weight: bold; color: var(--text-dark); margin: 10px 0; }
        .hangman-keyboard { margin-top: 20px; }
        .hangman-keyboard button { margin: 4px; padding: 8px 10px; font-size: 1rem; cursor: pointer; background-color: #6c757d; color: white; border: none; border-radius: 5px; min-width: 35px; }
        .hangman-keyboard button:hover { background-color: #5a6268; }
        .hangman-keyboard button:disabled { background-color: #ccc; cursor: not-allowed; opacity: 0.6; }
        .hangman-message { color: var(--incorrect-color); font-weight: bold; margin-top: 15px; min-height: 24px; font-size: 1.1rem; }
        .hangman-score { font-size: 1.1rem; color: var(--correct-color); margin: 10px 0; font-weight: bold; }
        .hangman-game-controls button { margin: 0 10px; }
        
        /* --- Reward Animation --- */
        .reward-animation { /* ... (bez zmian) ... */ position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background-color: rgba(0,0,0,0.5); z-index: 1000; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; }
        .reward-animation.show { opacity: 1; pointer-events: auto; }
        .reward-content { /* ... (bez zmian) ... */ background-color: white; border-radius: 20px; padding: 30px; text-align: center; box-shadow: var(--card-shadow); animation: pop 0.5s ease; }
        @keyframes pop { /* ... (bez zmian) ... */ 0%{transform: scale(0.8);} 50%{transform: scale(1.1);} 100%{transform: scale(1);} }
        .reward-title { /* ... (bez zmian) ... */ font-size: 2rem; color: var(--primary); margin-bottom: 15px; }
        .reward-stars { /* ... (bez zmian) ... */ font-size: 3rem; color: gold; margin-bottom: 20px; animation: spin 1s ease; }
        @keyframes spin { /* ... (bez zmian) ... */ 0%{transform: rotate(-30deg);} 100%{transform: rotate(0);} }
        .continue-button { /* ... (bez zmian) ... */ background-color: var(--primary); color: white; border: none; border-radius: 10px; padding: 12px 25px; font-family: 'Bubblegum Sans', cursive; font-size: 1.1rem; cursor: pointer; transition: all 0.3s ease; }
        .continue-button:hover { background-color: #ff5252; transform: scale(1.05); }
        
        /* --- Responsive --- */
        @media (max-width: 768px) {
            .header h1 { font-size: 1.8rem; }
            .dashboard { padding: 15px; gap: 15px; }
            .module-card { min-height: 180px; }
            .module-icon { width: 60px; height: 60px; }
            .module-icon i { font-size: 1.8rem; }
            .module-title { font-size: 1.3rem; }
            .time-grid { grid-template-columns: 1fr; }
            .fill-blank { width: 100%; margin: 5px 0; } /* Stack inputs on mobile */
            .hangman-keyboard button { padding: 6px 8px; font-size: 0.9rem; min-width: 30px;}
            .hangman-word-display { font-size: 1.5rem; letter-spacing: 5px;}
        }
    </style>
</head>
<body>
    <!-- Main Header -->
    <header class="header">
        <h1>Angielski dla Dzieci</h1>
        <p>Pory dnia, dni tygodnia, czas, liczby i czynności</p>
    </header>
    
    <!-- Dashboard with Modules -->
    <div class="dashboard">
        <!-- Time of Day Module -->
        <div class="module-card time-module" data-section="time-section">
            <div class="module-icon"><i class="fas fa-sun"></i></div>
            <h3 class="module-title">Pory Dnia</h3>
            <p class="module-description">Poznaj pory dnia po angielsku: morning, afternoon, evening, night.</p>
            <div class="module-badge"><i class="fas fa-star"></i> Łatwe</div>
            <div class="progress-container"><div class="progress-bar" id="time-progress"></div></div>
        </div>
        
        <!-- Days of the Week Module -->
        <div class="module-card days-module" data-section="days-section">
            <div class="module-icon"><i class="fas fa-calendar-day"></i></div>
            <h3 class="module-title">Dni Tygodnia</h3>
            <p class="module-description">Poznaj dni tygodnia po angielsku: Monday, Tuesday, Wednesday...</p>
            <div class="module-badge"><i class="fas fa-star"></i> Łatwe</div>
            <div class="progress-container"><div class="progress-bar" id="days-progress"></div></div>
        </div>
        
        <!-- Telling Time Module -->
        <div class="module-card clock-module" data-section="clock-section">
            <div class="module-icon"><i class="fas fa-clock"></i></div>
            <h3 class="module-title">Godziny</h3>
            <p class="module-description">Naucz się podawać godziny po angielsku: o'clock, half past, quarter to...</p>
            <div class="module-badge"><i class="fas fa-star"></i><i class="fas fa-star"></i> Średnie</div>
            <div class="progress-container"><div class="progress-bar" id="clock-progress"></div></div>
        </div>

        <!-- Numbers 1-100 Module (NEW) -->
        <div class="module-card numbers-module" data-section="numbers-section">
             <div class="module-icon"><i class="fas fa-sort-numeric-up"></i></div>
             <h3 class="module-title">Liczby 1-100</h3>
             <p class="module-description">Naucz się liczyć do stu po angielsku i poprawnie zapisywać liczby.</p>
             <div class="module-badge"><i class="fas fa-star"></i><i class="fas fa-star"></i> Średnie</div>
             <div class="progress-container"><div class="progress-bar" id="numbers-progress"></div></div>
        </div>
        
        <!-- Present Simple Module -->
        <div class="module-card present-simple-module" data-section="present-simple-section">
            <div class="module-icon"><i class="fas fa-language"></i></div>
            <h3 class="module-title">Present Simple</h3>
            <p class="module-description">Naucz się tworzyć zdania twierdzące i przeczące w czasie Present Simple.</p>
            <div class="module-badge"><i class="fas fa-star"></i><i class="fas fa-star"></i> Średnie</div>
            <div class="progress-container"><div class="progress-bar" id="present-simple-progress"></div></div>
        </div>

        <!-- Frequency Adverbs Module -->
        <div class="module-card adverbs-module" data-section="adverbs-section">
             <div class="module-icon"><i class="fas fa-redo-alt"></i></div>
             <h3 class="module-title">Jak często? (Przysłówki)</h3>
             <p class="module-description">Poznaj słowa takie jak always, usually, sometimes, never i ich miejsce w zdaniu.</p>
             <div class="module-badge"><i class="fas fa-star"></i><i class="fas fa-star"></i> Średnie</div>
             <div class="progress-container"><div class="progress-bar" id="adverbs-progress"></div></div>
        </div>
        
        <!-- Daily Activities Vocabulary Module -->
        <div class="module-card vocabulary-module" data-section="vocabulary-section">
            <div class="module-icon"><i class="fas fa-book"></i></div>
            <h3 class="module-title">Codzienne Czynności</h3>
            <p class="module-description">Poznaj słownictwo związane z czynnościami wykonywanymi każdego dnia.</p>
            <div class="module-badge"><i class="fas fa-star"></i><i class="fas fa-star"></i> Średnie</div>
            <div class="progress-container"><div class="progress-bar" id="vocabulary-progress"></div></div>
        </div>

        <!-- Hangman Module (NEW integration) -->
        <div class="module-card hangman-module" data-section="hangman-section">
             <div class="module-icon"><i class="fas fa-gamepad"></i></div>
             <h3 class="module-title">Wisielec - Słówka</h3>
             <p class="module-description">Sprawdź swoją znajomość słówek z poprzednich działów w grze w wisielca!</p>
             <div class="module-badge"><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i> Trudne</div>
             <div class="progress-container"><div class="progress-bar" id="hangman-progress"></div></div>
        </div>

    </div>
    
    <!-- Section Containers (Time, Days, Clock, Numbers, Present Simple, Adverbs, Vocabulary) -->
    <!-- Time of Day Section -->
    <div class="section-container time-section" id="time-section">
        <div class="section-header">
            <button class="back-button" data-section="time-section"><i class="fas fa-arrow-left"></i></button>
            <h2 class="section-title">Pory Dnia</h2>
        </div>
        <div class="section-content">
            <!-- Explanation Card -->
            <div class="explanation-card">
                <h3>Pory dnia po angielsku:</h3>
                <div class="time-grid">
                    <div class="time-card"><div class="time-icon"><i class="fas fa-sun" style="color: #FFD700;"></i></div><div class="time-title">Morning</div><div class="time-activities">Rano</div></div>
                    <div class="time-card"><div class="time-icon"><i class="fas fa-cloud-sun" style="color: #FF9800;"></i></div><div class="time-title">Afternoon</div><div class="time-activities">Popołudnie</div></div>
                    <div class="time-card"><div class="time-icon"><i class="fas fa-moon" style="color: #673AB7;"></i></div><div class="time-title">Evening</div><div class="time-activities">Wieczór</div></div>
                    <div class="time-card"><div class="time-icon"><i class="fas fa-star" style="color: #3F51B5;"></i></div><div class="time-title">Night</div><div class="time-activities">Noc</div></div>
                </div>
                <h3 style="margin-top: 25px;">Przydatne wyrażenia:</h3>
                <div class="explanation-examples">
                    <div class="example-item">Good morning!</div><div class="example-item">Good afternoon!</div><div class="example-item">Good evening!</div><div class="example-item">Good night!</div>
                    <div class="example-item">In the morning</div><div class="example-item">In the afternoon</div><div class="example-item">In the evening</div><div class="example-item">At night</div>
                </div>
            </div>
             <!-- Exercise Card -->
            <div class="exercise-card">
                <h3>Ćwiczenia: Pory Dnia (Wybierz)</h3>
                <div class="exercise">
                    <p class="exercise-question">1. O jakiej porze jemy śniadanie?</p>
                    <div class="options-grid time-options" data-correct="In the morning">
                        <div class="option-item">In the morning</div><div class="option-item">In the afternoon</div>
                        <div class="option-item">In the evening</div><div class="option-item">At night</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">2. Co mówimy o 14:00?</p>
                    <div class="options-grid time-options" data-correct="Good afternoon">
                        <div class="option-item">Good morning</div><div class="option-item">Good afternoon</div>
                        <div class="option-item">Good evening</div><div class="option-item">Good night</div>
                    </div>
                </div>
                 <div class="exercise">
                    <p class="exercise-question">3. Kiedy zazwyczaj oglądamy gwiazdy?</p>
                    <div class="options-grid time-options" data-correct="At night">
                        <div class="option-item">In the morning</div><div class="option-item">In the afternoon</div>
                        <div class="option-item">In the evening</div><div class="option-item">At night</div>
                    </div>
                </div>
                 <div class="exercise">
                    <p class="exercise-question">4. O jakiej porze dnia zazwyczaj kończymy lekcje w szkole?</p>
                    <div class="options-grid time-options" data-correct="In the afternoon">
                        <div class="option-item">In the morning</div><div class="option-item">In the afternoon</div>
                        <div class="option-item">In the evening</div><div class="option-item">At night</div>
                    </div>
                </div>
                <!-- Writing Exercise -->
                <div class="writing-exercise">
                    <h4>Ćwiczenie: Pory Dnia (Uzupełnij)</h4>
                    <p>1. Mówimy <input type="text" class="fill-blank" data-answer="good night">, kiedy idziemy spać.</p>
                    <p>2. Jemy obiad (dinner) zazwyczaj <input type="text" class="fill-blank" data-answer="in the evening">.</p>
                    <p>3. Widzimy słońce <input type="text" class="fill-blank" data-answer="in the morning"> i <input type="text" class="fill-blank" data-answer="in the afternoon">.</p>
                </div>
                <button class="check-button" data-check="time-section">Sprawdź odpowiedzi</button>
            </div>
        </div>
    </div>

    <!-- Days of the Week Section -->
    <div class="section-container days-section" id="days-section">
         <div class="section-header">
            <button class="back-button" data-section="days-section"><i class="fas fa-arrow-left"></i></button>
            <h2 class="section-title">Dni Tygodnia</h2>
        </div>
        <div class="section-content">
             <!-- Explanation Card -->
            <div class="explanation-card">
                <h3>Dni tygodnia po angielsku:</h3>
                <table class="days-table">
                    <tr><th>Po angielsku</th><th>Po polsku</th></tr>
                    <tr><td>Monday</td><td>Poniedziałek</td></tr>
                    <tr><td>Tuesday</td><td>Wtorek</td></tr>
                    <tr><td>Wednesday</td><td>Środa</td></tr>
                    <tr><td>Thursday</td><td>Czwartek</td></tr>
                    <tr><td>Friday</td><td>Piątek</td></tr>
                    <tr><td>Saturday</td><td>Sobota</td></tr>
                    <tr><td>Sunday</td><td>Niedziela</td></tr>
                </table>
                <h3 style="margin-top: 25px;">Ważne informacje:</h3>
                <ul style="margin-left: 20px; line-height: 1.6;">
                    <li>Dni tygodnia w języku angielskim zawsze piszemy <strong>wielką literą</strong>.</li>
                    <li>Używamy przyimka <strong>"on"</strong> przed dniem tygodnia, np. <em>on Monday</em>.</li>
                </ul>
                <h3 style="margin-top: 25px;">Przydatne wyrażenia:</h3>
                <div class="explanation-examples">
                    <div class="example-item">Today is...</div><div class="example-item">Yesterday was...</div>
                    <div class="example-item">Tomorrow is...</div><div class="example-item">on Monday</div>
                    <div class="example-item">What day is it today?</div>
                </div>
            </div>
             <!-- Exercise Card -->
            <div class="exercise-card">
                <h3>Ćwiczenia: Dni Tygodnia (Wybierz)</h3>
                <div class="exercise">
                    <p class="exercise-question">1. Jaki dzień następuje po środzie (Wednesday)?</p>
                    <div class="options-grid days-options" data-correct="Thursday">
                        <div class="option-item">Monday</div><div class="option-item">Tuesday</div>
                        <div class="option-item">Thursday</div><div class="option-item">Friday</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">2. Jaki dzień jest przed sobotą (Saturday)?</p>
                    <div class="options-grid days-options" data-correct="Friday">
                        <div class="option-item">Thursday</div><div class="option-item">Friday</div>
                        <div class="option-item">Sunday</div><div class="option-item">Monday</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">3. Które dni to weekend?</p>
                    <div class="options-grid days-options" data-correct="Saturday and Sunday">
                        <div class="option-item">Tuesday and Wednesday</div><div class="option-item">Thursday and Friday</div>
                        <div class="option-item">Saturday and Sunday</div><div class="option-item">Friday and Monday</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">4. Jak poprawnie powiemy "w niedzielę"?</p>
                    <div class="options-grid days-options" data-correct="on Sunday">
                        <div class="option-item">In Sunday</div><div class="option-item">On Sunday</div>
                        <div class="option-item">At Sunday</div><div class="option-item">By Sunday</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">5. Które zdanie jest napisane poprawnie?</p>
                    <div class="options-grid days-options" data-correct="I go to school on Monday.">
                        <div class="option-item">I go to school on monday.</div>
                        <div class="option-item">I go to school on Monday.</div>
                        <div class="option-item">I go school on Monday.</div>
                        <div class="option-item">I go to school in Monday.</div>
                    </div>
                </div>
                <!-- Writing Exercise -->
                 <div class="writing-exercise">
                    <h4>Ćwiczenie: Dni Tygodnia (Uzupełnij)</h4>
                    <p>1. Pierwszy dzień tygodnia roboczego to <input type="text" class="fill-blank" data-answer="monday">.</p>
                    <p>2. Ostatni dzień tygodnia (weekendowy) to <input type="text" class="fill-blank" data-answer="sunday">.</p>
                    <p>3. Dzień pomiędzy Tuesday i Thursday to <input type="text" class="fill-blank" data-answer="wednesday">.</p>
                 </div>
                <button class="check-button" data-check="days-section">Sprawdź odpowiedzi</button>
            </div>
        </div>
    </div>

    <!-- Telling Time Section -->
    <div class="section-container clock-section" id="clock-section">
        <div class="section-header">
            <button class="back-button" data-section="clock-section"><i class="fas fa-arrow-left"></i></button>
            <h2 class="section-title">Godziny</h2>
        </div>
         <div class="section-content">
             <!-- Explanation Card -->
            <div class="explanation-card">
                <h3>Określanie czasu po angielsku:</h3>
                <div class="clock-exercise">
                    <div class="clock-item"><div class="clock-display"><div class="clock-hand hour-hand" style="--hour-rotation: 0deg;"></div><div class="clock-hand minute-hand" style="--minute-rotation: 0deg;"></div><div class="clock-center"></div></div><div class="clock-time">3:00<br>It's three o'clock</div></div>
                    <div class="clock-item"><div class="clock-display"><div class="clock-hand hour-hand" style="--hour-rotation: 45deg;"></div><div class="clock-hand minute-hand" style="--minute-rotation: 180deg;"></div><div class="clock-center"></div></div><div class="clock-time">4:30<br>It's half past four</div></div>
                    <div class="clock-item"><div class="clock-display"><div class="clock-hand hour-hand" style="--hour-rotation: 90deg;"></div><div class="clock-hand minute-hand" style="--minute-rotation: 90deg;"></div><div class="clock-center"></div></div><div class="clock-time">6:15<br>It's quarter past six</div></div>
                    <div class="clock-item"><div class="clock-display"><div class="clock-hand hour-hand" style="--hour-rotation: 135deg;"></div><div class="clock-hand minute-hand" style="--minute-rotation: 270deg;"></div><div class="clock-center"></div></div><div class="clock-time">7:45<br>It's quarter to eight</div></div>
                </div>
                <h3>Podstawowe wyrażenia:</h3>
                <ul style="margin-left: 20px; line-height: 1.6;">
                    <li><strong>o'clock</strong> - pełna godzina (np. 3:00)</li>
                    <li><strong>half past...</strong> - wpół do... (np. 4:30 - half past four)</li>
                    <li><strong>quarter past...</strong> - kwadrans po... (np. 6:15 - quarter past six)</li>
                    <li><strong>quarter to...</strong> - za kwadrans... (np. 7:45 - quarter to eight)</li>
                    <li><strong>... minutes past ...</strong> - ... minut po ...</li>
                    <li><strong>... minutes to ...</strong> - za ... minut ...</li>
                </ul>
                <h3 style="margin-top: 25px;">AM i PM:</h3>
                <div class="explanation-examples"><div class="example-item">AM - od północy do południa (rano)</div><div class="example-item">PM - od południa do północy (po południu/wieczorem)</div></div>
                <h3 style="margin-top: 25px;">Pytania:</h3>
                <div class="explanation-examples"><div class="example-item">What time is it?</div><div class="example-item">What time do you...?</div></div>
            </div>
             <!-- Exercise Card -->
            <div class="exercise-card">
                <h3>Ćwiczenia: Godziny (Wybierz)</h3>
                <div class="exercise">
                    <p class="exercise-question">1. Jak powiesz "Jest 5:00"?</p>
                    <div class="options-grid clock-options" data-correct="It's five o'clock">
                        <div class="option-item">It's five hours</div><div class="option-item">It's five o'clock</div>
                        <div class="option-item">It's half past five</div><div class="option-item">It's clock five</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">2. Jak powiesz "Jest 8:30"?</p>
                    <div class="options-grid clock-options" data-correct="It's half past eight">
                        <div class="option-item">It's half to nine</div><div class="option-item">It's half past eight</div>
                        <div class="option-item">It's eight and thirty</div><div class="option-item">It's half nine</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">3. Jak powiesz "Jest 7:15"?</p>
                    <div class="options-grid clock-options" data-correct="It's quarter past seven">
                        <div class="option-item">It's quarter to seven</div><div class="option-item">It's quarter past seven</div>
                        <div class="option-item">It's seven fifteen o'clock</div><div class="option-item">It's fifteen past seven</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">4. Jak powiesz "Jest 9:45"?</p>
                    <div class="options-grid clock-options" data-correct="It's quarter to ten">
                        <div class="option-item">It's quarter past nine</div><div class="option-item">It's quarter to ten</div>
                        <div class="option-item">It's nine forty-five</div><div class="option-item">It's fifteen to ten</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">5. Co oznacza "7:00 PM"?</p>
                    <div class="options-grid clock-options" data-correct="Siódma wieczorem">
                        <div class="option-item">Siódma rano</div><div class="option-item">Siódma wieczorem</div>
                        <div class="option-item">Za siedem siódma</div><div class="option-item">Siódma po południu</div>
                    </div>
                </div>
                <!-- Writing Exercise -->
                <div class="writing-exercise">
                    <h4>Ćwiczenie: Godziny (Napisz słowami)</h4>
                    <p>1. 2:00 -> It's <input type="text" class="fill-blank" data-answer="two o'clock">.</p>
                    <p>2. 10:30 -> It's <input type="text" class="fill-blank" data-answer="half past ten">.</p>
                    <p>3. 1:15 -> It's <input type="text" class="fill-blank" data-answer="quarter past one">.</p>
                    <p>4. 11:45 -> It's <input type="text" class="fill-blank" data-answer="quarter to twelve">.</p>
                 </div>
                 <button class="check-button" data-check="clock-section">Sprawdź odpowiedzi</button>
            </div>
         </div>
    </div>

     <!-- Numbers 1-100 Section (NEW) -->
    <div class="section-container numbers-section" id="numbers-section">
        <div class="section-header">
            <button class="back-button" data-section="numbers-section"><i class="fas fa-arrow-left"></i></button>
            <h2 class="section-title">Liczby 1-100</h2>
         </div>
         <div class="section-content">
            <div class="explanation-card">
                <h3>Liczby 1-100 po angielsku:</h3>
                <p>Nauczmy się liczyć!</p>
                <div class="numbers-grid">
                     <!-- Generate numbers 1-100 dynamically or list them -->
                     <div class="number-item"><strong>1</strong> one</div>
                     <div class="number-item"><strong>2</strong> two</div>
                     <div class="number-item"><strong>3</strong> three</div>
                     <div class="number-item"><strong>4</strong> four</div>
                     <div class="number-item"><strong>5</strong> five</div>
                     <div class="number-item"><strong>6</strong> six</div>
                     <div class="number-item"><strong>7</strong> seven</div>
                     <div class="number-item"><strong>8</strong> eight</div>
                     <div class="number-item"><strong>9</strong> nine</div>
                     <div class="number-item"><strong>10</strong> ten</div>

                     <div class="number-item"><strong>11</strong> eleven</div>
                     <div class="number-item"><strong>12</strong> twelve</div>
                     <div class="number-item"><strong>13</strong> thirteen</div>
                     <div class="number-item"><strong>14</strong> fourteen</div>
                     <div class="number-item"><strong>15</strong> fifteen</div>
                     <div class="number-item"><strong>16</strong> sixteen</div>
                     <div class="number-item"><strong>17</strong> seventeen</div>
                     <div class="number-item"><strong>18</strong> eighteen</div>
                     <div class="number-item"><strong>19</strong> nineteen</div>
                     <div class="number-item"><strong>20</strong> twenty</div>

                     <div class="number-item"><strong>21</strong> twenty-one</div>
                     <div class="number-item"><strong>22</strong> twenty-two</div>
                     <div class="number-item">...</div>
                     <div class="number-item"><strong>30</strong> thirty</div>
                     <div class="number-item"><strong>31</strong> thirty-one</div>
                      <div class="number-item">...</div>
                     <div class="number-item"><strong>40</strong> forty</div>
                     <div class="number-item"><strong>50</strong> fifty</div>
                     <div class="number-item"><strong>60</strong> sixty</div>
                     <div class="number-item"><strong>70</strong> seventy</div>
                     <div class="number-item"><strong>80</strong> eighty</div>
                     <div class="number-item"><strong>90</strong> ninety</div>
                     <div class="number-item"><strong>100</strong> one hundred</div>
                </div>
                 <h3 style="margin-top: 25px;">Ważne zasady:</h3>
                 <ul style="margin-left: 20px; line-height: 1.6;">
                     <li>Liczby 13-19 mają końcówkę <strong>-teen</strong>.</li>
                     <li>Pełne dziesiątki (20, 30, 40...) mają końcówkę <strong>-ty</strong> (uwaga: forty, nie fourty!).</li>
                     <li>Liczby złożone (np. 21, 45, 87) tworzymy łącząc dziesiątkę z jednością myślnikiem (-), np. <strong>twenty-one</strong>, <strong>forty-five</strong>, <strong>eighty-seven</strong>.</li>
                 </ul>
            </div>
            <div class="exercise-card">
                <h3>Ćwiczenia: Liczby (Wybierz)</h3>
                 <div class="exercise">
                    <p class="exercise-question">1. Jak powiesz "25"?</p>
                    <div class="options-grid numbers-options" data-correct="twenty-five">
                        <div class="option-item">twenty five</div><div class="option-item">twenty-five</div>
                        <div class="option-item">two five</div><div class="option-item">twelve-five</div>
                    </div>
                 </div>
                 <div class="exercise">
                    <p class="exercise-question">2. Jaka liczba to "fourteen"?</p>
                    <div class="options-grid numbers-options" data-correct="14">
                        <div class="option-item">4</div><div class="option-item">14</div>
                        <div class="option-item">40</div><div class="option-item">44</div>
                    </div>
                 </div>
                 <div class="exercise">
                    <p class="exercise-question">3. Jaka liczba to "eighty"?</p>
                    <div class="options-grid numbers-options" data-correct="80">
                        <div class="option-item">8</div><div class="option-item">18</div>
                        <div class="option-item">80</div><div class="option-item">88</div>
                    </div>
                 </div>
                <div class="exercise">
                    <p class="exercise-question">4. Jak powiesz "53"?</p>
                    <div class="options-grid numbers-options" data-correct="fifty-three">
                        <div class="option-item">fifteen-three</div><div class="option-item">fivety-three</div>
                        <div class="option-item">fifty-three</div><div class="option-item">fifty three</div>
                    </div>
                </div>
                 <div class="exercise">
                     <p class="exercise-question">5. Która liczba jest większa: "nineteen" czy "ninety"?</p>
                    <div class="options-grid numbers-options" data-correct="ninety">
                        <div class="option-item">nineteen</div><div class="option-item">ninety</div>
                        <div class="option-item">są równe</div><div class="option-item">nie da się porównać</div>
                    </div>
                 </div>
                <!-- Writing Exercise -->
                 <div class="writing-exercise">
                    <h4>Ćwiczenie: Liczby (Napisz słowami/cyframi)</h4>
                    <p>1. 12 -> <input type="text" class="fill-blank" data-answer="twelve"></p>
                    <p>2. 40 -> <input type="text" class="fill-blank" data-answer="forty"></p>
                    <p>3. sixty-seven -> <input type="text" class="fill-blank" data-answer="67"></p>
                    <p>4. ninety-nine -> <input type="text" class="fill-blank" data-answer="99"></p>
                    <p>5. 100 -> one <input type="text" class="fill-blank" data-answer="hundred"></p>
                 </div>
                 <button class="check-button" data-check="numbers-section">Sprawdź odpowiedzi</button>
            </div>
         </div>
    </div>

    <!-- Present Simple Section -->
    <div class="section-container present-simple-section" id="present-simple-section">
        <div class="section-header">
            <button class="back-button" data-section="present-simple-section"><i class="fas fa-arrow-left"></i></button>
            <h2 class="section-title">Present Simple</h2>
        </div>
         <div class="section-content">
             <!-- Explanation Card -->
            <div class="explanation-card">
                <h3>Czas Present Simple:</h3>
                <p>Używamy, gdy mówimy o:</p>
                 <ul style="margin-left: 20px; line-height: 1.6;"><li>Czynnościach regularnych (codziennie, często)</li><li>Faktach</li><li>Planach, rozkładach</li></ul>
                <h3 style="margin-top: 25px;">Zdania twierdzące:</h3>
                <p>Podmiot + Czasownik (forma podst.) + Reszta zdania LUB<br>
                   Podmiot (He/She/It) + Czasownik + <strong>-s/-es</strong> + Reszta zdania.</p>
                <h3 style="margin-top: 25px;">Zdania przeczące:</h3>
                <p>Podmiot + <strong>don't/doesn't</strong> + Czasownik (forma podst.) + Reszta zdania.</p>
            </div>
             <!-- Exercise Card -->
            <div class="exercise-card">
                <h3>Ćwiczenia: Present Simple (Wybierz)</h3>
                <div class="exercise">
                    <p class="exercise-question">1. She __________ (do) her homework every day.</p>
                    <div class="options-grid present-simple-options" data-correct="does">
                        <div class="option-item">do</div><div class="option-item">does</div>
                        <div class="option-item">do homework</div><div class="option-item">don't do</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">2. We __________ (not/watch) TV in the morning.</p>
                    <div class="options-grid present-simple-options" data-correct="don't watch">
                        <div class="option-item">don't watch</div><div class="option-item">doesn't watch</div>
                        <div class="option-item">not watch</div><div class="option-item">watches not</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">3. Tom (He) __________ (go) to school at 8 o'clock.</p>
                    <div class="options-grid present-simple-options" data-correct="goes">
                        <div class="option-item">go</div><div class="option-item">goes</div>
                        <div class="option-item">is go</div><div class="option-item">going</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">4. They __________ (not/have) breakfast at 9:00.</p>
                    <div class="options-grid present-simple-options" data-correct="don't have">
                        <div class="option-item">don't have</div><div class="option-item">doesn't have</div>
                        <div class="option-item">not has</div><div class="option-item">not have</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">5. Które zdanie jest poprawne?</p>
                    <div class="options-grid present-simple-options" data-correct="She doesn't listen to music every day.">
                        <div class="option-item">She don't listen to music every day.</div>
                        <div class="option-item">She doesn't listens to music every day.</div>
                        <div class="option-item">She doesn't listen to music every day.</div>
                        <div class="option-item">She not listens music every day.</div>
                    </div>
                </div>
                <div class="exercise">
                    <p class="exercise-question">6. I __________ (tidy) my room on Saturday.</p>
                    <div class="options-grid present-simple-options" data-correct="tidy">
                        <div class="option-item">tidies</div><div class="option-item">tidy</div>
                        <div class="option-item">tidy up</div><div class="option-item">tidying</div>
                    </div>
                </div>
                <!-- Writing Exercise -->
                 <div class="writing-exercise">
                    <h4>Ćwiczenie: Present Simple (Uzupełnij)</h4>
                    <p>1. My cat (It) <input type="text" class="fill-blank" data-answer="sleeps"> a lot. (+) </p>
                    <p>2. You <input type="text" class="fill-blank" data-answer="don't like"> spinach. (-)</p>
                    <p>3. He <input type="text" class="fill-blank" data-answer="watches"> cartoons in the evening. (+) </p>
                    <p>4. We <input type="text" class="fill-blank" data-answer="go"> to the park on Sunday. (+) </p>
                    <p>5. She <input type="text" class="fill-blank" data-answer="doesn't play"> the piano. (-)</p>
                 </div>
                <button class="check-button" data-check="present-simple-section">Sprawdź odpowiedzi</button>
            </div>
         </div>
    </div>

    <!-- Frequency Adverbs Section -->
    <div class="section-container adverbs-section" id="adverbs-section">
         <div class="section-header">
            <button class="back-button" data-section="adverbs-section"><i class="fas fa-arrow-left"></i></button>
            <h2 class="section-title">Przysłówki Częstotliwości</h2>
         </div>
         <div class="section-content">
              <!-- Explanation Card -->
             <div class="explanation-card">
                 <h3>Jak często coś robisz?</h3>
                 <p>Używamy specjalnych słów (przysłówków częstotliwości), aby powiedzieć, jak często wykonujemy daną czynność:</p>
                 <ul style="margin-left: 20px; list-style: none; line-height: 1.8;">
                    <li><i class="fas fa-star" style="color: gold;"></i><i class="fas fa-star" style="color: gold;"></i><i class="fas fa-star" style="color: gold;"></i><i class="fas fa-star" style="color: gold;"></i><i class="fas fa-star" style="color: gold;"></i> <strong>always</strong> - zawsze (100%)</li>
                    <li><i class="fas fa-star" style="color: gold;"></i><i class="fas fa-star" style="color: gold;"></i><i class="fas fa-star" style="color: gold;"></i><i class="fas fa-star" style="color: gold;"></i><i class="far fa-star"></i> <strong>usually</strong> - zazwyczaj (ok. 80-90%)</li>
                    <li><i class="fas fa-star" style="color: gold;"></i><i class="fas fa-star" style="color: gold;"></i><i class="fas fa-star" style="color: gold;"></i><i class="far fa-star"></i><i class="far fa-star"></i> <strong>often</strong> - często (ok. 60-70%)</li>
                    <li><i class="fas fa-star" style="color: gold;"></i><i class="fas fa-star" style="color: gold;"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i> <strong>sometimes</strong> - czasami (ok. 30-50%)</li>
                    <li><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i> <strong>never</strong> - nigdy (0%)</li>
                 </ul>
                 <h3 style="margin-top: 25px;">Miejsce w zdaniu:</h3>
                 <p>Te słowa stawiamy zazwyczaj:</p>
                 <ul style="margin-left: 20px; line-height: 1.6;">
                    <li><strong>Przed</strong> głównym czasownikiem: <em>I <strong>always</strong> get up early. | She <strong>often</strong> reads books.</em></li>
                    <li><strong>Po</strong> czasowniku 'to be' (am, is, are): <em>He <strong>is always</strong> happy. | We <strong>are never</strong> late.</em></li>
                 </ul>
             </div>
             <!-- Exercise Card -->
             <div class="exercise-card">
                 <h3>Ćwiczenia: Przysłówki Częstotliwości (Wybierz)</h3>
                 <div class="exercise">
                     <p class="exercise-question">1. Jeśli robisz coś każdego dnia, użyjesz słowa:</p>
                     <div class="options-grid adverbs-options" data-correct="always">
                         <div class="option-item">sometimes</div><div class="option-item">never</div>
                         <div class="option-item">always</div><div class="option-item">often</div>
                     </div>
                 </div>
                 <div class="exercise">
                     <p class="exercise-question">2. Które zdanie jest poprawne?</p>
                     <div class="options-grid adverbs-options" data-correct="She often tidies her room.">
                         <div class="option-item">She tidies often her room.</div><div class="option-item">She often tidies her room.</div>
                         <div class="option-item">Often she tidies her room.</div><div class="option-item">She tidies her room often.</div>
                     </div>
                 </div>
                 <div class="exercise">
                     <p class="exercise-question">3. Które zdanie jest poprawne?</p>
                     <div class="options-grid adverbs-options" data-correct="He is never sad.">
                         <div class="option-item">He never is sad.</div><div class="option-item">He is never sad.</div>
                         <div class="option-item">Never he is sad.</div><div class="option-item">He is sad never.</div>
                     </div>
                 </div>
                 <div class="exercise">
                     <p class="exercise-question">4. Jak powiesz "Oni czasami grają w piłkę"?</p>
                     <div class="options-grid adverbs-options" data-correct="They sometimes play football.">
                         <div class="option-item">They play sometimes football.</div><div class="option-item">They sometimes play football.</div>
                         <div class="option-item">Sometimes they plays football.</div><div class="option-item">They plays football sometimes.</div>
                     </div>
                 </div>
                 <div class="exercise">
                     <p class="exercise-question">5. Co oznacza "usually"?</p>
                     <div class="options-grid adverbs-options" data-correct="zazwyczaj">
                         <div class="option-item">zawsze</div><div class="option-item">często</div>
                         <div class="option-item">nigdy</div><div class="option-item">zazwyczaj</div>
                     </div>
                 </div>
                <!-- Writing Exercise -->
                 <div class="writing-exercise">
                    <h4>Ćwiczenie: Przysłówki (Uzupełnij)</h4>
                    <p>Użyj przysłówka w nawiasie we właściwym miejscu:</p>
                    <p>1. I <input type="text" class="fill-blank" data-answer="always"> do my homework. (always)</p>
                    <p>2. She is <input type="text" class="fill-blank" data-answer="never"> late for school. (never)</p>
                    <p>3. We <input type="text" class="fill-blank" data-answer="sometimes"> watch TV in the evening. (sometimes)</p>
                    <p>4. He <input type="text" class="fill-blank" data-answer="usually"> plays computer games. (usually)</p>
                 </div>
                 <button class="check-button" data-check="adverbs-section">Sprawdź odpowiedzi</button>
             </div>
         </div>
    </div>
    
    <!-- Daily Activities Vocabulary Section -->
    <div class="section-container vocabulary-section" id="vocabulary-section">
        <div class="section-header">
            <button class="back-button" data-section="vocabulary-section"><i class="fas fa-arrow-left"></i></button>
            <h2 class="section-title">Codzienne Czynności</h2>
        </div>
         <div class="section-content">
             <!-- Explanation Card -->
             <div class="explanation-card">
                <h3>Słownictwo: Czynności codzienne</h3>
                <div class="verb-cards">
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-book"></i></div><div class="verb-english">do my homework</div><div class="verb-polish">odrabiać pracę domową</div></div>
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-bed"></i></div><div class="verb-english">get up</div><div class="verb-polish">wstawać</div></div>
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-moon"></i></div><div class="verb-english">go to bed</div><div class="verb-polish">iść do łóżka</div></div>
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-school"></i></div><div class="verb-english">go to school</div><div class="verb-polish">iść do szkoły</div></div>
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-users"></i></div><div class="verb-english">hang out with friends</div><div class="verb-polish">spotykać się z przyjaciółmi</div></div>
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-shower"></i></div><div class="verb-english">have a shower</div><div class="verb-polish">brać prysznic</div></div>
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-coffee"></i></div><div class="verb-english">have breakfast</div><div class="verb-polish">jeść śniadanie</div></div>
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-utensils"></i></div><div class="verb-english">have dinner</div><div class="verb-polish">jeść obiad/kolację</div></div>
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-chalkboard-teacher"></i></div><div class="verb-english">have lessons</div><div class="verb-polish">mieć lekcje</div></div>
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-hamburger"></i></div><div class="verb-english">have lunch</div><div class="verb-polish">jeść lunch</div></div>
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-music"></i></div><div class="verb-english">listen to music</div><div class="verb-polish">słuchać muzyki</div></div>
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-broom"></i></div><div class="verb-english">tidy my room</div><div class="verb-polish">sprzątać pokój</div></div>
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-tv"></i></div><div class="verb-english">watch TV</div><div class="verb-polish">oglądać TV</div></div>
                    <div class="verb-card"><div class="verb-icon"><i class="fas fa-birthday-cake"></i></div><div class="verb-english">make cupcakes</div><div class="verb-polish">robić babeczki</div></div>
                     <!-- Dodaj więcej kart w razie potrzeby -->
                </div>
            </div>
             <!-- Exercise Card -->
             <div class="exercise-card">
                <h3>Ćwiczenia: Słownictwo (Wybierz)</h3>
                 <div class="exercise">
                    <p class="exercise-question">1. He ____________ at 7 o'clock every morning.</p>
                    <div class="options-grid vocabulary-options" data-correct="gets up">
                        <div class="option-item">gets up</div><div class="option-item">goes to bed</div>
                        <div class="option-item">has breakfast</div><div class="option-item">watches TV</div>
                    </div>
                 </div>
                 <div class="exercise">
                    <p class="exercise-question">2. I usually ____________ after school.</p>
                    <div class="options-grid vocabulary-options" data-correct="do my homework">
                        <div class="option-item">get up</div><div class="option-item">go to school</div>
                        <div class="option-item">do my homework</div><div class="option-item">hang out with friends</div>
                    </div>
                 </div>
                 <div class="exercise">
                    <p class="exercise-question">3. Co robisz przed pójściem do szkoły?</p>
                    <div class="options-grid vocabulary-options" data-correct="have breakfast">
                        <div class="option-item">have dinner</div><div class="option-item">go to bed</div>
                        <div class="option-item">have breakfast</div><div class="option-item">watch TV</div>
                    </div>
                 </div>
                 <div class="exercise">
                    <p class="exercise-question">4. She ____________ at 8:00 in the evening.</p>
                    <div class="options-grid vocabulary-options" data-correct="has dinner">
                        <div class="option-item">has breakfast</div><div class="option-item">has lunch</div>
                        <div class="option-item">has dinner</div><div class="option-item">has lessons</div>
                    </div>
                 </div>
                 <div class="exercise">
                    <p class="exercise-question">5. I like to ____________ on Saturday morning.</p>
                    <div class="options-grid vocabulary-options" data-correct="tidy my room">
                        <div class="option-item">tidy my room</div><div class="option-item">go to school</div>
                        <div class="option-item">do homework</div><div class="option-item">go to bed</div>
                    </div>
                 </div>
                 <div class="exercise">
                    <p class="exercise-question">6. They often ____________ on Friday evenings.</p>
                    <div class="options-grid vocabulary-options" data-correct="hang out with friends">
                        <div class="option-item">make cupcakes</div><div class="option-item">listen to music</div>
                        <div class="option-item">get up</div><div class="option-item">hang out with friends</div>
                    </div>
                 </div>
                <!-- Writing Exercise -->
                 <div class="writing-exercise">
                    <h4>Ćwiczenie: Czynności (Napisz)</h4>
                    <p>Co robisz na obrazku? Napisz po angielsku.</p>
                    <p>1. <i class="fas fa-tv"></i> -> I <input type="text" class="fill-blank" data-answer="watch TV">.</p>
                    <p>2. <i class="fas fa-bed"></i> -> He <input type="text" class="fill-blank" data-answer="gets up">.</p>
                    <p>3. <i class="fas fa-shower"></i> -> She <input type="text" class="fill-blank" data-answer="has a shower">.</p>
                    <p>4. <i class="fas fa-music"></i> -> We <input type="text" class="fill-blank" data-answer="listen to music">.</p>
                 </div>
                 <button class="check-button" data-check="vocabulary-section">Sprawdź odpowiedzi</button>
            </div>
         </div>
    </div>

    <!-- Hangman Section (NEW) -->
    <div class="section-container hangman-section" id="hangman-section">
        <div class="section-header">
            <button class="back-button" data-section="hangman-section"><i class="fas fa-arrow-left"></i></button>
            <h2 class="section-title">Wisielec - Słówka</h2>
        </div>
        <div class="section-content">
             <div class="hangman-container">
                 <!-- Setup Screen -->
                 <div class="hangman-setup-section" id="hangmanSetupSection">
                     <h3>Wybierz kategorię słówek:</h3>
                     <div class="hangman-category-buttons" id="hangmanCategoryButtons">
                         <!-- Buttons will be added by JS -->
                     </div>
                     <h3 style="margin-top: 20px;">Wybierz liczbę prób:</h3>
                     <div class="hangman-attempts-selector" id="hangmanAttemptsSelector">
                         <button data-attempts="8">8</button>
                         <button data-attempts="7">7</button>
                         <button data-attempts="6" class="active">6</button>
                         <button data-attempts="5">5</button>
                         <button data-attempts="4">4</button>
                     </div>
                     <button class="check-button" onclick="hangmanStartGame()">Start Wisielec!</button>
                 </div>

                 <!-- Game Screen -->
                 <div class="hangman-game-section hidden" id="hangmanGameSection">
                     <div class="hangman-score" id="hangmanScore">Wynik (poprawne słowa): 0</div>
                     <div class="hangman-attempts" id="hangmanAttempts">Pozostałe próby: 6</div>
                     <canvas id="hangmanCanvas" width="250" height="300"></canvas>
                     <div class="hangman-hint" id="hangmanHint">Hint: Polish Translation</div>
                     <div class="hangman-word-display" id="hangmanWordDisplay">_ _ _ _ _</div>
                     <div class="hangman-keyboard" id="hangmanKeyboard"></div>
                     <div class="hangman-message" id="hangmanMessage"></div>
                     <div class="hangman-game-controls" style="margin-top: 25px;">
                         <button class="check-button" onclick="hangmanNextWord()">Następne słowo</button>
                         <button class="check-button" onclick="hangmanShowSetup()">Zmień kategorię</button>
                     </div>
                 </div>
             </div>
        </div>
    </div>
    
    <!-- Reward Animation -->
    <div class="reward-animation" id="reward-animation">
         <!-- ... (bez zmian) ... -->
         <div class="reward-content">
            <h2 class="reward-title">Brawo!</h2>
            <div class="reward-stars">⭐⭐⭐</div>
            <p style="margin-bottom: 20px;">Świetnie Ci poszło! Ukończyłeś/aś ten moduł!</p>
            <button class="continue-button" id="continue-button">Kontynuuj naukę</button>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // -------- CORE APP LOGIC (Progress, Navigation, Rewards) --------
            
            const storageKey = 'kidsEnglishProgressV3'; // Increment version if data structure changes significantly
            const defaultProgress = {
                time: { completed: 0, total: 7 },
                days: { completed: 0, total: 8 },
                clock: { completed: 0, total: 9 },
                numbers: { completed: 0, total: 10 }, // 5 MC + 5 fill-in
                presentSimple: { completed: 0, total: 11 },
                adverbs: { completed: 0, total: 9 },
                vocabulary: { completed: 0, total: 10 },
                 // Hangman progress: completed = categories started/won first word in, total = number of categories
                hangman: { completed: 0, total: 6 } // Time, Days, Clock, Numbers, Adverbs, Vocabulary
            };
            let progressData = {};

            function isLocalStorageAvailable() { /* ... (bez zmian) ... */ try { localStorage.setItem('test','test');localStorage.removeItem('test'); return true; } catch(e) { return false; }}

            function loadProgress() {
                if (!isLocalStorageAvailable()) {
                    progressData = JSON.parse(JSON.stringify(defaultProgress)); // Use deep copy of default if no storage
                    console.warn("LocalStorage not available. Progress will not be saved.");
                    return;
                }
                const savedData = localStorage.getItem(storageKey);
                if (savedData) {
                    try {
                         progressData = JSON.parse(savedData);
                         // Ensure all keys from defaultProgress exist, add if missing, update total
                         for (const key in defaultProgress) {
                             if (!progressData[key] || typeof progressData[key].completed !== 'number' || typeof progressData[key].total !== 'number') {
                                 progressData[key] = { ...defaultProgress[key] }; // Copy default if missing/invalid
                             } else {
                                 progressData[key].total = defaultProgress[key].total; // Always update total from default
                             }
                         }
                         // Remove keys no longer in defaultProgress (optional cleanup)
                          for (const key in progressData) {
                              if (!defaultProgress[key]) {
                                  delete progressData[key];
                              }
                          }
                    }  catch (e) {
                         console.error("Error parsing saved progress, resetting.", e);
                         progressData = JSON.parse(JSON.stringify(defaultProgress));
                         localStorage.setItem(storageKey, JSON.stringify(progressData)); // Save the reset state
                    }
                 } else {
                     progressData = JSON.parse(JSON.stringify(defaultProgress));
                     localStorage.setItem(storageKey, JSON.stringify(progressData));
                 }
            }


            function updateProgressDisplays() { /* ... (bez zmian - iterates through progressData) ... */
                if (!isLocalStorageAvailable()) return;
                for (const sectionKey in progressData) {
                    const sectionData = progressData[sectionKey];
                    const progressBar = document.getElementById(`${sectionKey}-progress`);
                    if (progressBar && sectionData.total > 0) {
                         const progressPercent = Math.round((sectionData.completed / sectionData.total) * 100);
                         progressBar.style.width = `${progressPercent}%`;
                    } else if (progressBar) {
                         progressBar.style.width = '0%';
                    }
                }
            }
            
            function saveProgress(sectionKey, correctAnswersCount) { /* ... (slightly modified for clarity) ... */
                 if (!isLocalStorageAvailable() || !progressData[sectionKey]) return;
                 const sectionData = progressData[sectionKey];
                 const maxCompleted = sectionData.total;
                 // Update completed count - ensure it doesn't go over total
                 progressData[sectionKey].completed = Math.max(0, Math.min(correctAnswersCount, maxCompleted));

                 localStorage.setItem(storageKey, JSON.stringify(progressData));
                 updateProgressDisplays();

                 if (correctAnswersCount >= maxCompleted) {
                    // Only show reward if it's not the hangman section (handled separately)
                     if (sectionKey !== 'hangman') {
                         showReward();
                     }
                 }
            }
            
            function showReward() { /* ... (bez zmian) ... */ const rewardAnimation = document.getElementById('reward-animation'); if(rewardAnimation) rewardAnimation.classList.add('show'); }
            const continueButton = document.getElementById('continue-button');
             if (continueButton) {
                 continueButton.addEventListener('click', function() {
                     const rewardAnimation = document.getElementById('reward-animation');
                     if(rewardAnimation) rewardAnimation.classList.remove('show');
                 });
             }

              // --- Navigation ---
              function showSection(sectionId) {
                  hideAllSections();
                   const section = document.getElementById(sectionId);
                   if (section) {
                       section.style.display = 'block';
                       // If entering Hangman, maybe initialize setup screen
                       if(sectionId === 'hangman-section') {
                           hangmanInitializeSetup(); // Initialize categories etc.
                       }
                   } else {
                        // Fallback to dashboard if section not found
                        const dashboard = document.querySelector('.dashboard');
                        if (dashboard) dashboard.style.display = 'grid';
                   }
                  window.scrollTo(0, 0);
              }

              function hideAllSections() {
                  document.querySelectorAll('.section-container').forEach(container => {
                      container.style.display = 'none';
                  });
                  // Also hide dashboard if showing a section
                  const dashboard = document.querySelector('.dashboard');
                   if (dashboard) dashboard.style.display = 'none';
              }
             document.querySelectorAll('.module-card').forEach(card => { card.addEventListener('click', function() { showSection(this.dataset.section); }); });
             document.querySelectorAll('.back-button').forEach(button => {
                 button.addEventListener('click', function() {
                    hideAllSections();
                    const dashboard = document.querySelector('.dashboard');
                    if (dashboard) dashboard.style.display = 'grid'; // Show dashboard when going back
                     // If coming back from hangman game, hide game section
                     if (this.dataset.section === 'hangman-section') {
                         document.getElementById('hangmanGameSection').classList.add('hidden');
                         document.getElementById('hangmanSetupSection').classList.remove('hidden');
                     }

                 });
             });
            
             // --- Option Selection Handler ---
             document.querySelectorAll('.options-grid').forEach(grid => { /* ... (bez zmian) ... */
                 const options = grid.querySelectorAll('.option-item');
                 options.forEach(option => {
                     option.addEventListener('click', function() {
                         options.forEach(opt => opt.classList.remove('selected'));
                         this.classList.add('selected');
                     });
                 });
             });

             // --- Check Answers Function (for standard sections)---
             function checkSectionAnswers(sectionId) {
                 const sectionElement = document.getElementById(sectionId);
                 if (!sectionElement) return;

                 let correctCount = 0;
                 let totalCheckable = 0;

                 // 1. Check Multiple Choice Options
                 const optionsGrids = sectionElement.querySelectorAll('.options-grid');
                 totalCheckable += optionsGrids.length;
                 optionsGrids.forEach(grid => { /* ... (logic bez zmian) ... */
                      const selectedOption = grid.querySelector('.option-item.selected');
                      const correctAnswer = grid.dataset.correct; // Use dataset.correct directly
                      grid.querySelectorAll('.option-item').forEach(opt => opt.classList.remove('correct', 'incorrect'));
                      if (selectedOption) {
                          if (selectedOption.textContent.trim() === correctAnswer.trim()) { // Exact match needed now
                              selectedOption.classList.add('correct');
                              correctCount++;
                          } else {
                              selectedOption.classList.add('incorrect');
                              grid.querySelectorAll('.option-item').forEach(opt => {
                                 if (opt.textContent.trim() === correctAnswer.trim()) { opt.classList.add('correct'); }
                              });
                          }
                      }
                 });

                 // 2. Check Fill-in-the-Blank Inputs
                 const fillBlankInputs = sectionElement.querySelectorAll('.fill-blank');
                 totalCheckable += fillBlankInputs.length;
                 fillBlankInputs.forEach(input => { /* ... (logic bez zmian) ... */
                      const userAnswer = input.value.trim().toLowerCase();
                      const correctAnswer = input.dataset.answer.trim().toLowerCase();
                      input.classList.remove('correct', 'incorrect');
                      if (userAnswer === correctAnswer) {
                          input.classList.add('correct');
                          correctCount++;
                      } else if (userAnswer !== '') {
                          input.classList.add('incorrect');
                      }
                 });

                 const sectionKey = sectionId.replace('-section', '');
                 saveProgress(sectionKey, correctCount); // Save based on correct answers
                 
                 // Provide feedback
                 alert(`Twój wynik w tej sekcji: ${correctCount}/${totalCheckable} poprawnych odpowiedzi!`);

                 // Recalculate total in case HTML changed
                 if (isLocalStorageAvailable() && progressData[sectionKey] && progressData[sectionKey].total !== totalCheckable) {
                     console.warn(`Updating total questions for section ${sectionKey} from ${progressData[sectionKey].total} to ${totalCheckable}`);
                     progressData[sectionKey].total = totalCheckable;
                     localStorage.setItem(storageKey, JSON.stringify(progressData));
                 }
             }

             // Attach Check Button Listeners (for standard sections)
             document.querySelectorAll('.check-button').forEach(button => {
                 const sectionIdToCheck = button.dataset.check;
                 if (sectionIdToCheck !== 'hangman-section') { // Exclude hangman check button
                    button.addEventListener('click', function() {
                         checkSectionAnswers(sectionIdToCheck);
                    });
                 }
              });

            // -------- HANGMAN GAME LOGIC --------

            // 1. Word Data Preparation
            const hangmanWordsByCategory = {
                'Pory Dnia': [
                    { word: "morning", hint: "Rano" }, { word: "afternoon", hint: "Popołudnie" },
                    { word: "evening", hint: "Wieczór" }, { word: "night", hint: "Noc" }
                ],
                'Dni Tygodnia': [
                    { word: "monday", hint: "Poniedziałek" }, { word: "tuesday", hint: "Wtorek" },
                    { word: "wednesday", hint: "Środa" }, { word: "thursday", hint: "Czwartek" },
                    { word: "friday", hint: "Piątek" }, { word: "saturday", hint: "Sobota" },
                    { word: "sunday", hint: "Niedziela" }
                ],
                'Godziny': [
                    { word: "o'clock", hint: "Pełna godzina" }, { word: "half past", hint: "Wpół do" },
                    { word: "quarter past", hint: "Kwadrans po" }, { word: "quarter to", hint: "Za kwadrans" }
                ],
                'Liczby': [
                    { word: "eleven", hint: "11" }, { word: "twelve", hint: "12" }, { word: "thirteen", hint: "13" },
                    { word: "fourteen", hint: "14" }, { word: "fifteen", hint: "15" }, { word: "twenty", hint: "20" },
                    { word: "thirty", hint: "30" }, { word: "forty", hint: "40" }, { word: "fifty", hint: "50" },
                    { word: "hundred", hint: "100" }
                ],
                 'Częstotliwość': [
                    { word: "always", hint: "Zawsze" }, { word: "usually", hint: "Zazwyczaj" },
                    { word: "often", hint: "Często" }, { word: "sometimes", hint: "Czasami" },
                    { word: "never", hint: "Nigdy" }
                 ],
                'Czynności': [
                    { word: "get up", hint: "Wstawać" }, { word: "go to bed", hint: "Iść spać" },
                    { word: "homework", hint: "Praca domowa" }, { word: "breakfast", hint: "Śniadanie" },
                    { word: "lunch", hint: "Drugie śniadanie" }, { word: "dinner", hint: "Obiad/Kolacja" },
                    { word: "shower", hint: "Prysznic" }, { word: "tidy room", hint: "Sprzątać pokój" },
                    { word: "watch tv", hint: "Oglądać TV" }, { word: "listen music", hint: "Słuchać muzyki" } // Removed "to" for simplicity
                 ]
            };

            // 2. Hangman Variables
            let hangmanCanvas, hangmanCtx;
            let hangmanCurrentCategory = '';
            let hangmanCurrentWords = [];
            let hangmanCurrentWord = null;
            let hangmanGuessedLetters = [];
            let hangmanRemainingAttempts = 6;
            let hangmanMaxAttempts = 6;
            let hangmanScore = 0;
            let hangmanWordIndex = 0;
             let hangmanCompletedCategories = new Set(progressData.hangman ? progressData.hangman.completedCategories || [] : []); // Load completed categories

             // 3. Hangman Element References
            const hangmanSetupSection = document.getElementById('hangmanSetupSection');
            const hangmanGameSection = document.getElementById('hangmanGameSection');
            const hangmanCategoryButtonsContainer = document.getElementById('hangmanCategoryButtons');
            const hangmanAttemptsSelector = document.getElementById('hangmanAttemptsSelector');
            const hangmanScoreDisplay = document.getElementById('hangmanScore');
            const hangmanAttemptsDisplay = document.getElementById('hangmanAttempts');
            const hangmanHintDisplay = document.getElementById('hangmanHint');
            const hangmanWordDisplay = document.getElementById('hangmanWordDisplay');
            const hangmanKeyboardContainer = document.getElementById('hangmanKeyboard');
            const hangmanMessageDisplay = document.getElementById('hangmanMessage');

            // 4. Hangman Functions

            function hangmanInitializeSetup() {
                // Populate category buttons
                hangmanCategoryButtonsContainer.innerHTML = ''; // Clear previous buttons
                for (const category in hangmanWordsByCategory) {
                    const button = document.createElement('button');
                    button.textContent = category;
                    button.dataset.category = category;
                    button.onclick = () => selectHangmanCategory(category, button);
                    // Highlight if category started/completed
                     if (hangmanCompletedCategories.has(category)) {
                         button.style.backgroundColor = 'var(--correct-color)'; // Indicate completed
                         button.title = "Kategoria ukończona!";
                      }
                    hangmanCategoryButtonsContainer.appendChild(button);
                }
                 // Set initial attempts highlight
                 document.querySelectorAll('#hangmanAttemptsSelector button').forEach(btn => {
                      btn.classList.toggle('active', parseInt(btn.dataset.attempts) === hangmanMaxAttempts);
                 });
            }

            function selectHangmanCategory(category, buttonElement) {
                 hangmanCurrentCategory = category;
                 // Optional: Highlight selected button visually
                 document.querySelectorAll('#hangmanCategoryButtons button').forEach(btn => btn.classList.remove('active'));
                 if(buttonElement) buttonElement.classList.add('active');
                 console.log("Selected category:", category); // For debugging
            }

             function selectHangmanAttempts(attempts, buttonElement) {
                 hangmanMaxAttempts = attempts;
                 hangmanRemainingAttempts = attempts; // Reset attempts when changing max
                 document.querySelectorAll('#hangmanAttemptsSelector button').forEach(btn => btn.classList.remove('active'));
                 if(buttonElement) buttonElement.classList.add('active');
                 if(hangmanAttemptsDisplay) hangmanAttemptsDisplay.textContent = `Pozostałe próby: ${hangmanRemainingAttempts}`; // Update display immediately
            }
             // Attach listeners to attempts buttons AFTER they are created
             document.querySelectorAll('#hangmanAttemptsSelector button').forEach(button => {
                 button.addEventListener('click', () => selectHangmanAttempts(parseInt(button.dataset.attempts), button));
             });


            function hangmanStartGame() {
                if (!hangmanCurrentCategory) {
                    alert("Proszę wybrać kategorię słówek!");
                    return;
                }
                hangmanScore = 0; // Reset score for the new session in this category
                hangmanUpdateScoreDisplay();
                hangmanCurrentWords = shuffleArray([...hangmanWordsByCategory[hangmanCurrentCategory]]);
                hangmanWordIndex = 0;

                hangmanSetupSection.classList.add('hidden');
                hangmanGameSection.classList.remove('hidden');
                hangmanLoadNextWord();
            }

            function hangmanLoadNextWord() {
                if (hangmanWordIndex >= hangmanCurrentWords.length) {
                    hangmanMessageDisplay.textContent = `Gratulacje! Ukończyłeś kategorię: ${hangmanCurrentCategory}!`;
                    hangmanMarkCategoryComplete(hangmanCurrentCategory); // Mark and save completion
                    disableHangmanKeyboard();
                    return;
                }

                hangmanCurrentWord = hangmanCurrentWords[hangmanWordIndex];
                hangmanGuessedLetters = [];
                hangmanRemainingAttempts = hangmanMaxAttempts; // Reset for new word
                hangmanUpdateAttemptsDisplay();
                hangmanMessageDisplay.textContent = '';
                hangmanHintDisplay.textContent = `Hint: ${hangmanCurrentWord.hint}`;
                hangmanUpdateWordDisplay();
                createHangmanKeyboard();
                hangmanDraw(0); // Reset hangman drawing
            }

            function hangmanUpdateWordDisplay() {
                 if (!hangmanCurrentWord) return;
                 const display = hangmanCurrentWord.word.toUpperCase().split('').map(letter => {
                     if (letter === ' ') return '\u00A0\u00A0'; // Represent space clearly
                     return hangmanGuessedLetters.includes(letter) ? letter : '_';
                 }).join(' ');
                 hangmanWordDisplay.textContent = display;
            }

            function createHangmanKeyboard() {
                 hangmanKeyboardContainer.innerHTML = '';
                 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('').forEach(letter => {
                     const button = document.createElement('button');
                     button.textContent = letter;
                     button.dataset.letter = letter;
                     button.onclick = () => hangmanGuessLetter(letter);
                      // Keep disabled if letter already guessed for current word
                      button.disabled = hangmanGuessedLetters.includes(letter);
                     hangmanKeyboardContainer.appendChild(button);
                 });
            }

            function hangmanGuessLetter(letter) {
                if (hangmanGuessedLetters.includes(letter) || !hangmanCurrentWord) return;

                hangmanGuessedLetters.push(letter);
                const button = hangmanKeyboardContainer.querySelector(`button[data-letter="${letter}"]`);
                if (button) button.disabled = true;

                const wordUpper = hangmanCurrentWord.word.toUpperCase();
                if (!wordUpper.includes(letter)) {
                    hangmanRemainingAttempts--;
                    hangmanUpdateAttemptsDisplay();
                    hangmanDraw(hangmanMaxAttempts - hangmanRemainingAttempts);

                    if (hangmanRemainingAttempts <= 0) {
                        hangmanMessageDisplay.textContent = `Koniec prób! Słowo to: ${hangmanCurrentWord.word.toUpperCase()}`;
                        disableHangmanKeyboard();
                        // Optionally reveal the word fully
                        hangmanWordDisplay.textContent = wordUpper.split('').join(' ');
                        // Don't auto-advance, let user click "Next Word"
                    }
                } else {
                    hangmanUpdateWordDisplay();
                    checkHangmanWordComplete();
                }
            }

            function checkHangmanWordComplete() {
                 if (!hangmanCurrentWord) return;
                 const wordUpper = hangmanCurrentWord.word.toUpperCase();
                 const isComplete = wordUpper.split('').every(letter => letter === ' ' || hangmanGuessedLetters.includes(letter));

                 if (isComplete) {
                     hangmanScore++;
                     hangmanUpdateScoreDisplay();
                     hangmanMessageDisplay.textContent = 'Dobrze! Słowo odgadnięte!';
                     disableHangmanKeyboard();
                     // Don't auto-advance immediately. User clicks "Next Word".
                      // Mark category as started/completed IF it wasn't already
                       if (!hangmanCompletedCategories.has(hangmanCurrentCategory)) {
                           hangmanMarkCategoryComplete(hangmanCurrentCategory);
                       }
                 }
            }

            function hangmanMarkCategoryComplete(category) {
                 if (!isLocalStorageAvailable()) return;
                 hangmanCompletedCategories.add(category);
                 // Update the main progressData for hangman
                  progressData.hangman.completed = hangmanCompletedCategories.size;
                  // Save the overall progress data, which now includes updated hangman state
                  localStorage.setItem(storageKey, JSON.stringify(progressData));
                  // Update the dashboard progress bar
                 updateProgressDisplays();
                 // Update category button appearance in setup too
                 const catButton = hangmanCategoryButtonsContainer.querySelector(`button[data-category="${category}"]`);
                 if(catButton) {
                      catButton.style.backgroundColor = 'var(--correct-color)';
                      catButton.title = "Kategoria ukończona!";
                 }
            }

            function hangmanNextWord() {
                hangmanWordIndex++;
                hangmanLoadNextWord();
            }


            function hangmanUpdateScoreDisplay() { hangmanScoreDisplay.textContent = `Wynik (poprawne słowa): ${hangmanScore}`; }
            function hangmanUpdateAttemptsDisplay() { hangmanAttemptsDisplay.textContent = `Pozostałe próby: ${hangmanRemainingAttempts}`; }
            function disableHangmanKeyboard() { hangmanKeyboardContainer.querySelectorAll('button').forEach(btn => btn.disabled = true); }
            function hangmanShowSetup() { hangmanGameSection.classList.add('hidden'); hangmanSetupSection.classList.remove('hidden'); }

            // Hangman Drawing
            function hangmanDraw(stage) {
                 if(!hangmanCtx) return; // Ensure context exists
                hangmanCtx.clearRect(0, 0, hangmanCanvas.width, hangmanCanvas.height);
                hangmanCtx.strokeStyle = '#333'; // Darker color
                hangmanCtx.lineWidth = 4; // Thicker lines
                hangmanCtx.lineCap = 'round'; // Rounded ends

                // Base
                if (stage >= 1) { hangmanCtx.beginPath(); hangmanCtx.moveTo(30, 280); hangmanCtx.lineTo(220, 280); hangmanCtx.stroke(); }
                // Pole
                if (stage >= 2) { hangmanCtx.beginPath(); hangmanCtx.moveTo(60, 280); hangmanCtx.lineTo(60, 40); hangmanCtx.lineTo(150, 40); hangmanCtx.stroke(); }
                // Rope
                if (stage >= 3) { hangmanCtx.beginPath(); hangmanCtx.moveTo(150, 40); hangmanCtx.lineTo(150, 80); hangmanCtx.stroke(); }
                // Head
                if (stage >= 4) { hangmanCtx.beginPath(); hangmanCtx.arc(150, 100, 20, 0, Math.PI * 2); hangmanCtx.stroke(); }
                // Body
                if (stage >= 5) { hangmanCtx.beginPath(); hangmanCtx.moveTo(150, 120); hangmanCtx.lineTo(150, 190); hangmanCtx.stroke(); }
                // Left Arm
                if (stage >= 6) { hangmanCtx.beginPath(); hangmanCtx.moveTo(150, 140); hangmanCtx.lineTo(110, 160); hangmanCtx.stroke(); }
                // Right Arm
                if (stage >= 7) { hangmanCtx.beginPath(); hangmanCtx.moveTo(150, 140); hangmanCtx.lineTo(190, 160); hangmanCtx.stroke(); }
                 // Left Leg
                 if (stage >= 8 && hangmanMaxAttempts >= 8) { hangmanCtx.beginPath(); hangmanCtx.moveTo(150, 190); hangmanCtx.lineTo(120, 240); hangmanCtx.stroke(); }
                 // Right Leg (Only draw if max attempts allow for 8 distinct stages or more)
                 if (stage >= (hangmanMaxAttempts >= 8 ? 8 : 7) && hangmanRemainingAttempts <= 0) { // Draw last leg on final failure if few attempts
                    hangmanCtx.beginPath(); hangmanCtx.moveTo(150, 190); hangmanCtx.lineTo(180, 240); hangmanCtx.stroke();
                 } else if (stage >= 8 && hangmanMaxAttempts >= 8) { // Standard draw for 8+ attempts
                     hangmanCtx.beginPath(); hangmanCtx.moveTo(150, 190); hangmanCtx.lineTo(180, 240); hangmanCtx.stroke();
                 }
            }


            // --- INITIALIZATION ---
            loadProgress(); // Load progress first
            updateProgressDisplays(); // Update dashboard bars
            // Get Canvas context for Hangman AFTER DOM is loaded
             hangmanCanvas = document.getElementById('hangmanCanvas');
             if(hangmanCanvas) {
                 hangmanCtx = hangmanCanvas.getContext('2d');
             } else {
                  console.error("Hangman canvas not found!");
             }
            hangmanInitializeSetup(); // Prepare category buttons etc.

        });
    </script>
</body>
</html>
